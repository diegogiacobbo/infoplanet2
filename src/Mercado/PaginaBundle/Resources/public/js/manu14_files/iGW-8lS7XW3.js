/*1365003945,178142547*/

if (self.CavalryLogger) { CavalryLogger.start_js(["nUaE7"]); }

__d("RelationshipStatus",["ArbiterMixin","CSS","DOM","Event","copyProperties"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('CSS'),i=b('DOM'),j=b('Event'),k=b('copyProperties');function l(m,n,o,p,q){this.init(m,n,o,p,q);}k(l,{UNDEFINED:0,SINGLE:1,WIDOWED:7,SEPARATED:8,DIVORCED:9,StatusChangeEvent:'STATUS_CHANGE',PartnerChangeEvent:'PARTNER_CHANGE',CheckAnniversaryEvent:'ANNIVERSARY',register:function(m,n){m.subscribe(this.CheckAnniversaryEvent,function(o,p){h.conditionClass(n,'hidden_elem',!p);});},isPartnerlessStatus:function(m){return m==l.UNDEFINED||m==l.SINGLE||m==l.WIDOWED||m==l.SEPARATED||m==l.DIVORCED;}});k(l.prototype,g,{init:function(m,n,o,p,q){this.relationship=m;this.friendselector=n;this.pending=o;this.current=p;this.root=q;this.friendselector.subscribe('init',this.onLoad.bind(this));j.listen(this.relationship,'change',this.changedStatus.bind(this));},onLoad:function(){this.friendselector.subscribe('select',function(m,n){this.select(n);}.bind(this));this.friendselector.subscribe('unselect',function(m,n){this.unselect();}.bind(this));},showWarnings:function(){var m=this.getRelationshipStatus(),n=l.isPartnerlessStatus(m),o=i.find(this.root,'div.statusChange'),p=i.find(this.root,'div.pendingPartner'),q=i.scry(this.root,'div.statusSingle')[0],r=i.scry(this.root,'div.pendingStatus')[0],s=this.friendselector.getSelectedId(),t=!n&&this.current.partner&&this.current.status!=m&&this.current.partner.uid==s;this.inform(l.StatusChangeEvent,{status:this.getRelationshipStatus(),partnerless:n,partner:(n?null:s)});var u=!n&&s&&(!this.current.partner||this.current.partner.uid!=s);if(u)this.inform(l.PartnerChangeEvent,{old_partner:(this.current.partner?this.current.partner.uid:null),new_partner:s,partner_changed:u});var v=this.current.partner&&this.current.partner.uid==s&&this.current.status==m&&this.current.pending;this.checkAnniversary();h.conditionShow(p,u);h.conditionShow(o,t);if(q){var w=n&&(this.current.status!==m);h.conditionShow(q,w);}if(r)h.conditionShow(r,v);},getRelationshipStatus:function(){return this.relationship.options[this.relationship.selectedIndex].value;},changedStatus:function(event){var m=event.getTarget().value,n=i.find(this.root,'div.relPartner'),o=l.isPartnerlessStatus(m);h.setClass(this.root,'relStatus_'+m);h.conditionClass(n,'hidden_elem',o);this.showWarnings();},select:function(m){i.setContent(this.pending,m.selected.text);this.checkAnniversary();this.showWarnings();},unselect:function(m){this.checkAnniversary();this.showWarnings();},checkAnniversary:function(){var m=this.friendselector.getSelectedId()&&!l.isPartnerlessStatus(this.getRelationshipStatus());this.inform(l.CheckAnniversaryEvent,m);}});e.exports=l;});
__d("OGCollectionAddCuration",["AsyncRequest","DataStore","DOM","copyProperties","tidyEvent"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('DataStore'),i=b('DOM'),j=b('copyProperties'),k=b('tidyEvent'),l='OGCollectionAddCuration';function m(n,o,p,q,r){this._container=n;this._control=o;this._itemID=p;this._surface=r;if(o)k([o.subscribe('reload',this.reloadControl.bind(this))]);var s=q?q:p;h.set(String(s),l,this);}j(m,{handleDeleteAction:function(n){var o=h.get(String(n),l);if(o)o.reloadControl();},handleAddItemSuccess:function(n,o,p){var q=h.get(String(n),l);h.set(String(o),l,q);q.insertMenuIntoDialog(p);},hideControl:function(n){var o=h.get(String(n),l);o.hideControl();},insertControl:function(n,o){var p=h.get(String(n),l);p.replaceControl(o);}});j(m.prototype,{hideControl:function(){this._control.hide();},reloadControl:function(){var n=new g('/ajax/collections/add_curation').setData({itemid:this._itemID,surface:this._surface,forceedit:true}).setHandler(this._handleAddCurationResponse.bind(this));n.send();},insertMenuIntoDialog:function(n){this._control.insertMenuIntoDialog(n);},replaceControl:function(n){i.replace(this._container,n);},_handleAddCurationResponse:function(n){this._control.destroy();i.replace(this._container,n.payload);}});e.exports=m;});
__d("OGCollectionAddObject",["AsyncRequest","CSS","DOM","DOMQuery","Form","JSLogger","Parent","TidyArbiterMixin","TimelineSection","copyProperties","csx","cx","ge"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('CSS'),i=b('DOM'),j=b('DOMQuery'),k=b('Form'),l=b('JSLogger'),m=b('Parent'),n=b('TidyArbiterMixin'),o=b('TimelineSection'),p=b('copyProperties'),q=b('csx'),r=b('cx'),s=b('ge'),t=l.create('og_collection_add_object'),u=p({ADD_PLACEHOLDER:'OGCollectionAddObject/addPlaceholder',NEW_ITEM:'OGCollectionAddObject/newItem',PLACEHOLDER:'OGCollectionAddObject/placeholder',REMOVE_PLACEHOLDER:'OGCollectionAddObject/removePlaceholder',init:function(v,w,x,y,z){o.callWithSection(z,function(aa){this.initImpl(v,w,x,y,aa.getNode(),z,aa.id);}.bind(this));},initInReport:function(v,w,x,y){this.initImpl(v,w,x,y,y.parentNode,null,null);},initImpl:function(v,w,x,y,z,aa,ba){var ca=j.scry(z,"._620")[0];if(!ca){t.error('grid_not_found',{collection_id:aa,section:ba,csx:'.public/fbTimelineCollectionGrid/root'});return;}w.subscribe('select',function(da,ea){if(!ea.selected.uid||ea.selected.type.indexOf('disabled')!=-1)return;u.inform(u.ADD_PLACEHOLDER,aa);var fa=ca.nextSibling,ga=null;if(fa&&h.hasClass(fa,"_3t3")){h.hide(ca.lastChild);ga=ca.lastChild;}var ha=i.prependContent(ca,x.cloneNode(true))[0];u.inform(u.PLACEHOLDER,{grid:ca});var ia=p({action:'add',mechanism:'typeahead'},k.serialize(y));ha.setAttribute('data-item',ia.item_id);new g().setURI(v).setData(ia).setRelativeTo(ca).setErrorHandler(function(ja){i.remove(ha);u.inform(u.REMOVE_PLACEHOLDER,aa);ga&&h.show(ga);}).setHandler(function(ja){ga&&i.remove(ga);}).setFinallyHandler(function(ja){u.inform(u.PLACEHOLDER,{grid:ca});}).send();});},replaceItem:function(v,w,x){var y=i.scry(v,'div[data-obj="'+w+'"]')[0];if(y){var z=m.byClass(y,"_30f");if(z)u.inform(u.REMOVE_PLACEHOLDER,z.id);i.remove(y.parentNode);}var aa=i.find(v,'[data-item="'+w+'"]'+"._gx9");i.replace(aa,x);this.inform(u.NEW_ITEM,{grid:v,newItem:x});},prependItem:function(v,w){var x=j.scry(s(v),"._620")[0];i.prependContent(x,w);this.inform(u.NEW_ITEM,{grid:x,newItem:w});}},n);e.exports=u;});
__d("TimelineCollectionsCuration",["getContextualParent","CSS","Parent","$","cx"],function(a,b,c,d,e,f){var g=b('getContextualParent'),h=b('CSS'),i=b('Parent'),j=b('$'),k=b('cx'),l={hideAppSection:function(m){var n=g(j(m),true),o=['getTimelineUnitFromChildElement','getMedleyAppSectionFromChildElement'];for(var p=0;p<o.length;p++){var q=l[o[p]](n);if(q)return h.hide(q);}},getTimelineUnitFromChildElement:function(m){return i.byClass(m,'fbTimelineUnit');},getMedleyAppSectionFromChildElement:function(m){return i.byClass(m,"_30f");}};e.exports=l;});
__d("OGCollectionAddToggle",["CSS","DOM","Event","TimelineCollectionsCuration","csx","cx","tidyEvent"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('Event'),j=b('TimelineCollectionsCuration'),k=b('csx'),l=b('cx'),m=b('tidyEvent'),n={},o="_4__4";function p(r,s,t){g.conditionShow(r,t);g.conditionClass(s,o,t);}var q={initTypeaheadToggleInReport:function(r,s,t){h.prependContent(h.find(j.getTimelineUnitFromChildElement(r),"._70o"),s);if(n[t]===undefined){n[t]=g.hasClass(s,o);}else p(r,s,n[t]);m(i.listen(s,'click',function(u){p(r,s,n[t]=!n[t]);}));}};e.exports=q;});
__d("OGCollectionAddedIconPlaceholder",["CSS","DataStore","DOM","DOMQuery","Event","copyProperties","csx","tidyEvent"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DataStore'),i=b('DOM'),j=b('DOMQuery'),k=b('Event'),l=b('copyProperties'),m=b('csx'),n=b('tidyEvent'),o='OGCollectionAddedIconPlaceholder';function p(q,r,s){this._dialog=s;this._icon=r;n(k.listen(r,'click',s.show.bind(s)));h.set(String(q),o,this);}l(p,{loadEditMenu:function(q,r){var s=h.get(String(q),o);s.insertIntoDialog(r);}});l(p.prototype,{destroy:function(){this._dialog.destroy();},getIcon:function(){return this._icon;},hide:function(){g.hide(this._icon);this._dialog.hide();},insertIntoDialog:function(q){i.setContent(j.find(this._dialog.getContent(),"._51rr"),q);}});e.exports=p;});
__d("HubsTypeaheadView",["Class","ContextualTypeaheadView","copyProperties","CSS","DOM","Event","tx"],function(a,b,c,d,e,f){var g=b('Class'),h=b('ContextualTypeaheadView'),i=b('copyProperties'),j=b('CSS'),k=b('DOM'),l=b('Event'),m=b('tx');function n(o,p){this.parent.construct(this,o,p);}g.extend(n,h);i(n,{initFreeformBoxes:function(){var o=k.scry(document,'div.fbAddFormDialog')[0];if(!o)return;var p=k.find(o,'form');l.listen(p,'submit',function(){k.scry(p,'div.fbFreeformInput').forEach(function(q){if(k.find(q,'input.inputtext').value)j.addClass(q.firstChild,'selected');});});}});i(n.prototype,{_createFreeFormNode:function(o){return {text:this.showCreatePrompt?m._("Add \"{partial_name}\"",{partial_name:o}):o,orig_text:o,type:'calltoaction'};},render:function(o,p,q){if(this.alwaysRender&&o!=='')if(this.allowFreeformEntry){p.push({uid:'0',text:o,type:'calltoaction'});}else{var r=o.toLowerCase().trim(),s=false;for(var t=0;t<p.length;t++)if(r==p[t].text.toLowerCase().trim()){s=true;break;}if(!s)p.push(this._createFreeFormNode(o));}return this.parent.render(o,p,q);}});e.exports=n;});
__d("TimelineAboutUnitRow",["CSS","Event","Parent","RelationshipStatus","copyProperties","cx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('Event'),i=b('Parent'),j=b('RelationshipStatus'),k=b('copyProperties'),l=b('cx');function m(n,o,p){this._root=n;this._listeners=[];this._typeaheadIsSet=false;this._selectorxIsSet=false;this._typeahead=o;if(o){this._listeners.push(o.subscribe('select',this.setTypeahead.bind(this)),o.subscribe('unselect',this.unsetTypeahead.bind(this)));}else this._typeaheadIsSet=true;if(p){this._listeners.push(p.subscribe('change',this.checkSelectorX.bind(this,p)),h.listen(p.getButton(),'mouseenter',g.removeClass.curry(i.byClass(p.getButton(),"_51iq"),"_51ir")));}else this._selectorxIsSet=true;}k(m.prototype,{checkSelectorX:function(n){this._selectorxIsSet=n.getValue()!=='0';if(j.isPartnerlessStatus(n.getValue()))this._typeahead.getCore().reset();g.conditionClass(this._typeahead.getElement(),'hidden_elem',j.isPartnerlessStatus(n.getValue()));this.checkSetInputs();},setTypeahead:function(){this._typeaheadIsSet=true;this.checkSetInputs();},unsetTypeahead:function(){this._typeaheadIsSet=false;this.checkSetInputs();},checkSetInputs:function(){var n=g.hasClass(this._typeahead.getElement(),'hidden_elem');g.conditionClass(this._root,'expanded',(n||this._typeaheadIsSet)&&this._selectorxIsSet);}});e.exports=m;});
__d("TimelineOGCollectionReportGrid",["CSS","OGCollectionAddObject"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('OGCollectionAddObject'),i={init:function(j,k){h.subscribe([h.NEW_ITEM,h.PLACEHOLDER],i.hideOverflowNodes.curry(j,k));},hideOverflowNodes:function(j,k,l,m){if(m.grid!=j)return;for(var n=0;n<j.childNodes.length;n++)g.conditionShow(j.childNodes[n],n<k);}};e.exports=i;});
__d("TypeaheadPreventSubmitOnEnter",["Event","Keys","copyProperties"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Keys'),i=b('copyProperties');function j(k){this._typeahead=k;}i(j.prototype,{_listener:null,enable:function(){var k=this._typeahead.getCore().getElement();this._listener=g.listen(k,'keypress',function(l){if(g.getKeyCode(l)==h.RETURN)l.kill();});},disable:function(){this._listener.remove();this._listener=null;}});e.exports=j;});
__d("legacy:PreventSubmitOnEnterTypeaheadBehavior",["TypeaheadPreventSubmitOnEnter"],function(a,b,c,d){var e=b('TypeaheadPreventSubmitOnEnter');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.preventSubmitOnEnter=function(f){f.enableBehavior(e);};},3);
__d("TypeaheadSetPhotoOnSelect",["Event","function-extensions","CSS","DOM","copyProperties"],function(a,b,c,d,e,f){var g=b('Event');b('function-extensions');var h=b('CSS'),i=b('DOM'),j=b('copyProperties');function k(l){this._typeahead=l;}j(k.prototype,{_eventListener:null,_subscription:null,enable:function(){var l=i.scry(this._typeahead.getElement(),'.photo')[0];if(l){if(!i.isNodeOfType(l,'img')){var m=i.create('img',{className:l.className});i.replace(l,m);l=m;}var n=h.hide.curry(l),o=h.show.curry(l);this._eventListener=g.listen(l,{load:o,error:n,abort:n});this._subscription=this._typeahead.subscribe('select',function(p,q){var r=q.selected.photo||this._typeahead.view.fallbackPhoto;r?l.setAttribute('src',r):n();}.bind(this));}},disable:function(){this._eventListener.remove();this._eventListener=null;this._typeahead.unsubscribe(this._subscription);this._subscription=null;}});e.exports=k;});
__d("legacy:SetPhotoOnSelectTypeaheadBehavior",["TypeaheadSetPhotoOnSelect"],function(a,b,c,d){var e=b('TypeaheadSetPhotoOnSelect');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.setPhotoOnSelect=function(f){f.enableBehavior(e);};},3);