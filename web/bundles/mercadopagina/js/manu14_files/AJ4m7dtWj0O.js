/*1364929718,178142493*/

if (self.CavalryLogger) { CavalryLogger.start_js(["vZK\/q"]); }

__d("Composer",["Event","function-extensions","Arbiter","ArbiterMixin","Button","CSS","DOM","Env","FileForm","Focus","HTML","Input","PageTransitions","Parent","Run","ServerJS","TextAreaControl","URI","URLScraper","$","copyProperties","ge","tx"],function(a,b,c,d,e,f){var g=b('Event');b('function-extensions');var h=b('Arbiter'),i=b('ArbiterMixin'),j=b('Button'),k=b('CSS'),l=b('DOM'),m=b('Env'),n=b('FileForm'),o=b('Focus'),p=b('HTML'),q=b('Input'),r=b('PageTransitions'),s=b('Parent'),t=b('Run'),u=b('ServerJS'),v=b('TextAreaControl'),w=b('URI'),x=b('URLScraper'),y=b('$'),z=b('copyProperties'),aa=b('ge'),ba=b('tx'),ca=1,da=4,ea={},fa=function(){var ja=l.scry(this.root,'span.linkAttachment')[0];if(!ja&&this.isMetaComposer)ja=l.scry(this.root,'span.attachmentAcceptsLink')[0];if(!ja)return;var ka=s.byTag(ja,'form');this.scraper=new x(this.input);this.scraper.subscribe('match',function(la,ma){if(this.isMetaComposer){var na=this.form.xhpc_targetid,oa=new w('/ajax/metacomposer/attachment/link/scraper.php');oa.addQueryData({scrape_url:encodeURIComponent(ma.url),alt_scrape_url:encodeURIComponent(ma.alt_url),targetid:na.value});ka.action=oa.toString();}else{k.show(ja);ka.action='/ajax/composer/attachment/link/scraper.php?scrape_url='+encodeURIComponent(ma.url);}ka.xhpc.value=ja.id;ka.xhpc.disabled=false;ka.xhpc.click();}.bind(this));this.isMetaComposer&&this.scraper.check();},ga=function(ja){if(this.inform('submit')===false){ja.kill();return false;}if(this.submitHandler)return (new Function(this.submitHandler)).apply(this.form);};function ha(ja,ka,la,ma,na){ea[ja.id]=this;this.root=ja;this.resetCfg=ka;this.dataSource=ma;this.lazyEndpoint=this.resetCfg&&this.resetCfg.lazyEndpoint;this.focus=l.find(ja,'div.focus_target');this.form=l.find(ja,'form.attachmentForm');this.content=l.find(ja,'div.attachmentContent');this.isMetaComposer=la;if(this.isMetaComposer){this.messageBox=l.find(ja,'div.uiMetaComposerMessageBox');this.metaArea=l.find(ja,'div.attachmentMetaArea');this.bottomArea=l.find(ja,'div.attachmentBottomArea');this.barArea=l.find(ja,'div.attachmentBarArea');this.auxBarArea=l.find(ja,'.attachmentAuxBarArea');this.blurb=l.find(ja,'div.uiMetaComposerMessageBox div.textBlurb');this.input=l.find(ja,'div.uiMetaComposerMessageBox textarea.input');this.button=l.find(ja,'div.uiMetaComposerMessageBox label.submitBtn');this.privacy=l.find(ja,'div.uiMetaComposerMessageBox li.privacyWidget');this.boosting=l.scry(ja,'div.uiMetaComposerMessageBox li.boostingWidget');}else{this.blurb=l.find(ja,'div.uiComposerMessageBox div.textBlurb');this.input=l.find(ja,'div.uiComposerMessageBox textarea.input');this.button=l.find(ja,'div.uiComposerMessageBox label.submitBtn');this.privacy=l.find(ja,'div.uiComposerMessageBox li.privacyWidget');this.boosting=[];}g.listen(this.form,'submit',ga.bind(this));if(this.isMetaComposer){g.listen(this.input,'focus',this.onFocus.bind(this));if(na){if(document.activeElement===this.input)this.onFocus.bind(this).defer();}else if(s.byClass(this.input,'child_was_focused'))this.onFocus.bind(this).defer();}h.inform('xhpc/construct/'+ja.id,this,h.BEHAVIOR_STATE);}z(ha.prototype,i,{init:function(ja){this.mentionsInput=ja;if(this.mentionsInput)this.mentionsInput.subscribe('init',function(){var ka=this.mentionsInput.getTypeahead().getView();ka.subscribe(['reset','render'],function(la){k.conditionClass(this.root,'uiComposerMention',(la=='render'));}.bind(this));}.bind(this));fa.call(this);this.inform('init',null,h.BEHAVIOR_PERSISTENT);this.setupListen();t.onBeforeUnload(this._handleUnsavedChanges.bind(this));},setupListen:function(){g.listen(this.root,'click',this.clickHandler.bind(this));},clickHandler:function(event){var ja=event.getTarget();if(s.byClass(ja,'collapsedPostButton'))this.focusInput.bind(this).defer();},setBlurb:function(ja){l.setContent(this.blurb,ja);},setEnabled:function(ja){j.setEnabled(this.button,ja);},getEndpoint:function(){return this.form.getAttribute('action');},setEndpoint:function(ja){this.form.setAttribute('action',ja);},setLoading:function(ja){k.conditionClass(this.root,'async_saving',!!ja);},setContentVisible:function(ja){k.conditionClass(this.root,'uiComposerHideContent',!ja);},setMessageBoxVisible:function(ja){k.conditionClass(this.root,'uiComposerHideMessageBox',!ja);},setInputVisible:function(ja){k.conditionClass(this.root,'uiComposerHideInput',!ja);},setStatusBoxVisible:function(ja){k.conditionClass(this.root,'uiComposerHideStatusBox',!ja);},setTopicTaggerVisible:function(ja){k.conditionClass(this.root,'uiTagComposerHidden',!ja);},mutate:function(ja){if(this.lastComposerInput)q.setValue(this.input,q.getValue(aa(this.lastComposerInput)));var ka=aa(ja.xhpc);if(ka){var la=l.scry(this.root,'.uiComposerAttachmentSelected')[0];if(ja.confirmAugmentation&&la!==ka)return;la&&k.removeClass(la,'uiComposerAttachmentSelected');k.addClass(ka,'uiComposerAttachmentSelected');if(!ja.disableCache)g.listen(ka,'click',function(na){na.stop();ja.disableCache=true;this.mutate(ja);}.bind(this));}if(!ja.keepContentAreas){this.setContentVisible(false);l.empty(this.content);if(this.isMetaComposer){this.mentionsInput&&this.mentionsInput.setAuxContent(null);l.empty(this.metaArea);l.empty(this.bottomArea);l.empty(this.barArea);l.empty(this.auxBarArea);}}if(ja.content){l.setContent(this.content,p(ja.content));this.setContentVisible(true);}if(this.isMetaComposer){ja.metaContent&&l.setContent(this.metaArea,p(ja.metaContent));ja.bottomContent&&l.setContent(this.bottomArea,p(ja.bottomContent));ja.barContent&&l.setContent(this.barArea,p(ja.barContent));ja.auxBarContent&&l.setContent(this.auxBarArea,p(ja.auxBarContent));}this.setMessageBoxVisible(!ja.messageBoxHidden);k.conditionClass(this.root,'uiComposerWhiteMessageBox',!ja.messageBoxHidden&&!ja.inputHidden&&!ja.content);this.setInputVisible(!ja.inputHidden);this.setStatusBoxVisible(!ja.statusBoxHidden);k.conditionShow(this.privacy,!ja.privacyWidgetHidden);if(this.boosting.length>0)k.conditionShow(this.boosting[0],!ja.boostingWidgetHidden);if(!ja.keepContentAreas){q.setPlaceholder(this.input,ja.placeholder);j.setLabel(this.button,ja.buttonLabel);}this.setBlurb(p(ja.blurb));if(ja.autoscrape){this.scraper&&this.scraper.enable();}else this.scraper&&this.scraper.disable();this.setEnabled(!ja.disabled);this.setTopicTaggerVisible(!ja.hideTopicTagger);this.setEndpoint(ja.endpoint);if(ja.formType==ca){this.form.setAttribute('rel','async');}else this.form.removeAttribute('rel');this.form.removeAttribute('target');if(ja.formType==da){if(!this._fileForm){this._fileForm=new n(this.form);this._fileForm.setAllowCrossOrigin(m.allowCrossOriginComposerUpload);this._fileForm.subscribe('submit',this.setLoading.bind(this,true));this._fileForm.subscribe('failure',this.setLoading.bind(this,false));}}else if(this._fileForm){this._fileForm.destroy();this._fileForm=null;}this.submitHandler=ja.submitHandler;this.lazyEndpoint=ja.lazyEndpoint;k.addClass(this.root,'uiComposerInteracted');k.addClass(this.root,'uiComposerOpen');if(ja.messageBoxFocused){var ma=document.activeElement;if(ma===document.body||s.byClass(ma,'attachmentLink'))this.focusInput.bind(this).defer();}if(ja.inputElement){q.setValue(aa(ja.inputElement),q.getValue(this.input));v.getInstance(aa(ja.inputElement)).update();}else v.getInstance(this.input).update();this.lastComposerInput=ja.inputElement;h.inform('composer/mutate',this);},subscribeToMutate:function(ja){return h.subscribe('composer/mutate',function(ka,la){if(la===this)ja();}.bind(this));},unsubscribeFromMutate:function(ja){ja.unsubscribe();},reset:function(ja){if(this.isMetaComposer){l.empty(this.metaArea);l.empty(this.bottomArea);l.empty(this.barArea);l.empty(this.auxBarArea);}if(this.resetCfg){this.mutate(this.resetCfg);}else{var ka=l.scry(this.root,'.uiComposerAttachmentSelected')[0];if(ka)k.removeClass(ka,'uiComposerAttachmentSelected');}if(!ja){q.reset(this.input);this.mentionsInput&&this.mentionsInput.reset();this.scraper&&this.scraper.reset();}k.removeClass(this.root,'uiComposerInteracted');k.setClass(this.focus,'focus_target');this.setLoading(false);h.inform('composer/reset');},onFocus:function(){if(this.lazyEndpoint){var ja=l.find(this.root,'form.attachmentSelectForm'),ka=new w(this.lazyEndpoint);ka.addQueryData({isAugmentation:true});ja.action=ka.toString();var la=l.scry(this.root,'.uiComposerAttachmentSelected')[0];ja.xhpc.value=la&&la.id;ja.xhpc.click();k.removeClass.curry(this.root,'async_saving').defer();}this.inform('focus');},focusInput:function(){o.set(this.input);},getInput:function(){return this.input;},updateDataSourceToken:function(ja){if(this.dataSource)this.dataSource.updateToken(ja);},_handleUnsavedChanges:function(){var ja=r.getNextURI();if(ja.getQueryData().hasOwnProperty('theater'))return;if(this.input.offsetParent!==null&&!q.isEmpty(this.input)&&!(a.Dialog&&a.Dialog.getCurrent()))return "You haven't finished your post yet. Do you want to leave without finishing?";}});var ia;z(ha,{setNodeToConfigure:function(ja){ia=ja;},configure:function(ja,ka,la){var ma=s.byClass(ia,'uiComposer').id,na=h.subscribe('xhpc/construct/'+ma,function(oa,pa){(function(){na.unsubscribe();}).defer();pa.mutate(ja);pa.subscribe('init',function(){new u().handle(ka);new Function(la)();if(ja.attachmentJS)new Function(ja.attachmentJS).call(pa);});});},publish:function(ja,ka){ka=ka||{};ka.composer_id=ja;ka.composer=ha.getInstance(ja);if(ka.streamNode){ka.streamStory=ka.streamNode;}else if(ka.streamMarkup)ka.streamStory=p(ka.streamMarkup).getRootNode();h.inform('composer/publish',ka);ka.composer&&ka.composer.reset(false);},finish:function(ja){ha.getInstance(ja).setLoading(false);},getInstance:function(ja){var ka=s.byClass(y(ja),'uiComposer');return ka?ea[ka.id]:null;}});e.exports=ha;});
__d("legacy:Composer",["Composer"],function(a,b,c,d){a.Composer=b('Composer');},3);
__d("ComposerXEmptyAttachment",["Class","ComposerXAttachment","copyProperties"],function(a,b,c,d,e,f){var g=b('Class'),h=b('ComposerXAttachment'),i=b('copyProperties');function j(k,l){this.parent.construct(this);this._root=k;if(l)this.attachmentClassName=l;}g.extend(j,h);i(j.prototype,{getRoot:function(){return this._root;}});e.exports=j;});
__d("ComposerXDatepickerIconReset",["CSS","cx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('cx');function i(j){g.removeClass(j.element,"_4_na");g.removeClass(j.element,"_509o");}e.exports=i;});
__d("FileUploadTarget",["AsyncUploadRequest","DragDropFileUpload","DragDropTarget","copyProperties","emptyFunction"],function(a,b,c,d,e,f){var g=b('AsyncUploadRequest'),h=b('DragDropFileUpload'),i=b('DragDropTarget'),j=b('copyProperties'),k=b('emptyFunction');function l(m,n){var o=(function(p){var q=new g(n).setFiles({file:p}).setRelativeTo(m).setStatusElement(m);q.subscribe('complete',function(r,s){this.onCompleteCallback(s);}.bind(this));q.send();}).bind(this);this.dragDropTarget=new i(m).setOnFilesDropCallback(function(p){p.length&&this.asyncProcess(p,function(q){q.length&&o(q);});}.bind(this));this.asyncProcess=function(p,q){q(p);};this.preprocess=function(p){return p;};this.onCompleteCallback=k;}j(l.prototype,{setPreprocessor:function(m){this.preprocess=m;return this;},setAsyncProcessor:function(m){this.asyncProcess=m;return this;},onComplete:function(m){this.onCompleteCallback=m;return this;},activate:function(){if(!h.isSupported())return;this.dragDropTarget.setFileFilter(this.preprocess).enable();}});e.exports=l;});
__d("SinglePictureUploadTarget",["Bootloader","Dialog","ErrorDialog","FileUploadTarget","copyProperties","emptyFunction","htmlSpecialChars","tx"],function(a,b,c,d,e,f){var g=b('Bootloader'),h=b('Dialog'),i=b('ErrorDialog'),j=b('FileUploadTarget'),k=b('copyProperties'),l=b('emptyFunction'),m=b('htmlSpecialChars'),n=b('tx');function o(p,q){this.fileUploadTarget=new j(p,q);this.preprocessCallback=l;this.oncompleteCallback=l;this.afterSuccessCallback=l;this.maxWidth=null;this.maxHeight=null;}k(o.prototype,{setPreprocessCallback:function(p){this.preprocessCallback=p;return this;},setOncompleteCallback:function(p){this.oncompleteCallback=p;return this;},setAfterSuccessCallback:function(p){this.afterSuccessCallback=p;return this;},setMaximumDimensions:function(p,q){this.maxWidth=p;this.maxHeight=q;return this;},activate:function(){var p=function(t){return m(t.name);},q=(function(t){if(t.length>1){i.show("Upload error",n._("You can only select {max-photos} photos to upload to this album.  Only the first {max-photos} photo you selected will be uploaded.",{'max-photos':1}));t=[t[0]];}var u=t[0];if(!u.type.match(/^image\//)){i.show("Upload error",n._("We could not understand the contents of {filename}.  Make sure it is a jpg, gif, or png formatted image.",{filename:p(u)}));return [];}this.preprocessCallback(t);return t;}).bind(this),r=(function(t,u){var v=1024*1024*16,w=1024*1024*1,x=function(z){if(z.size>v){i.show("Upload error",n._("{filename} is too large. Please resize your photo to under\u003CBR>8000x8000 pixels and try again.",{filename:p(t[0])}));u([]);}else u([z]);},y=t[0];if((y.size<w)||(!this.maxWidth&&!this.maxHeight)){x(y);}else g.loadModules(['ImageExif','ImageResizer'],function(z,aa){if(!aa.isSupported()){x(y);return;}var ba=new aa(y,this.maxWidth,this.maxHeight);ba.subscribe('resized',function(ca,da){if(da.size>y.size){x(y);}else x(da);}.bind(this));ba.subscribe('error',function(){x(y);}.bind(this));z.readFromFile(y,function(ca){ca&&ba.setOrientation(ca.Orientation);ba.resize();});});}).bind(this),s=(function(t){var u=t[0];this.oncompleteCallback(u);var v=u.getResponse().getPayload();if(u.isSuccess()){this.afterSuccessCallback(v);}else if(v&&v.__dialog){var w=new h();w._setFromModel(v.__dialog);w.setButtons(h.OK).show();}else i.show(v.error.title,v.error.body);}).bind(this);return this.fileUploadTarget.onComplete(s).setPreprocessor(q).setAsyncProcessor(r).activate();}});e.exports=o;});
__d("ProfilePOPAlbumEducationDialog",["Event","AsyncRequest"],function(a,b,c,d,e,f){var g=b('Event'),h=b('AsyncRequest'),i={listen:function(j,k){g.listen(j,'click',function(){k.show();new h().setURI('/ajax/profile/picture/record_seen_nux/').send();});}};e.exports=i;});
__d("BrokenProfilePicLogger",["Run","DOM","JSLogger"],function(a,b,c,d,e,f){var g=b("Run"),h=b("DOM"),i=b("JSLogger"),j=i.create("entities_profile_pics"),k={checkAndLog:function(l){g.onAfterLoad(function(){var m=h.find(l.parentNode,'img');if(!m.complete||(typeof m.naturalWidth!="undefined"&&m.naturalWidth===0))j.log('broken_link',{src:m.getAttribute('src')});});}};e.exports=k;});
__d("TimelineCommentsLoader",["Event","CommentPrelude","CSS","DOM","Parent","emptyFunction"],function(a,b,c,d,e,f){var g=b('Event'),h=b('CommentPrelude'),i=b('CSS'),j=b('DOM'),k=b('Parent'),l=b('emptyFunction'),m={init:function(){m.init=l;g.listen(document.body,'click',function(n){var o=k.byClass(n.getTarget(),'fbTimelineFeedbackCommentLoader');if(o){n.kill();h.click(o,false);var p=k.byTag(o,'form'),q=j.scry(p,'li.uiUfiViewAll input');if(!q.length)q=j.scry(p,'li.fbUfiViewPrevious input');if(!q.length)q=j.scry(p,'a.UFIPagerLink');q[0].click();i.show(j.find(p,'li.uiUfiComments'));i.removeClass(o,'fbTimelineFeedbackCommentLoader');}});}};e.exports=m;});
__d("TimelineDrag",["Event","ArbiterMixin","Locale","Style","Vector","copyProperties"],function(a,b,c,d,e,f){var g=b('Event'),h=b('ArbiterMixin'),i=b('Locale'),j=b('Style'),k=b('Vector'),l=b('copyProperties');function m(n,o,p){p=p||{};this._listenOn=p.listenOn;this._offsetInput=o;this._defaultOffset=p.default_offset;this._killClicks=p.killClicks;this._vertical=true;this._RTLXSwitch=false;this.setPicture(n,p);}l(m.prototype,h,{setPicture:function(n,o){if(!n)return false;o=o||{};this._picture=n;this._defaultOffset=o.default_offset;if(o.offsetInput)this._offsetInput=o.offsetInput;if(o.vertical!==undefined)this._vertical=o.vertical;if(o.height)this._containerHeight=o.height;if(o.width)this._containerWidth=o.width;if(this._vertical){this._offsetType='top';this._eventCoord='y';}else{this._RTLXSwitch=i.isRTL();this._offsetType='left';this._eventCoord='x';}if(this._picture.complete){this._initialLoad();}else this._loadListener=g.listen(this._picture,'load',function(){this._loadListener.remove();this._initialLoad();}.bind(this));},destroy:function(){this._stopDrag();this._saveOffset();this._mousedown&&this._mousedown.remove();this._onclick&&this._onclick.remove();this._loadListener&&this._loadListener.remove();},_initialLoad:function(){var n=this._listenOn?this._listenOn:this._picture;this._mousedown&&this._mousedown.remove();this._mousedown=g.listen(n,'mousedown',this._onMouseDown.bind(this));if(this._vertical){this._maxOffset=this._containerHeight-this._picture.offsetHeight;}else this._maxOffset=this._containerWidth-this._picture.offsetWidth;if(this._defaultOffset!==undefined)this._setOffset(this._defaultOffset);this._onclick&&this._onclick.remove();if(this._killClicks)this._onclick=g.listen(n,'click',this._onClick.bind(this));this._saveOffset();},_onClick:function(event){event.kill();},_onMouseDown:function(event){var n=parseInt(j.get(this._picture,this._offsetType),10)||0;this._pictureStartDragOffset=n-k.getEventPosition(event)[this._eventCoord];this._startDrag();event.kill();},_startDrag:function(){if(!this._dragStarted){this.inform('startdrag',this);this._dragTokens=[g.listen(document.documentElement,'mouseup',this._onMouseUp.bind(this)),g.listen(document.documentElement,'mousemove',this._onMouseMove.bind(this))];this._dragStarted=true;}},_saveOffset:function(){var n=parseInt(j.get(this._picture,this._offsetType),10);if(this._RTLXSwitch){this._offsetInput.value=n+this._containerWidth-this._picture.offsetWidth;}else this._offsetInput.value=n;},_stopDrag:function(){if(this._dragStarted){this.inform('stopdrag',this);this._dragStarted=false;this._dragTokens.forEach(function(n){n.remove();});this._saveOffset();}},_onMouseUp:function(event){this._stopDrag();event.kill();},_setOffset:function(n){if(this._RTLXSwitch){n=Math.max(0,Math.min(n,-this._maxOffset));}else n=Math.min(0,Math.max(n,this._maxOffset));j.set(this._picture,this._offsetType,n+'px');},_onMouseMove:function(event){this._setOffset(this._pictureStartDragOffset+k.getEventPosition(event)[this._eventCoord]);event.kill();}});e.exports=m;});
__d("TimelineCover",["Button","CSS","DOM","HTML","Parent","DOMScroll","TimelineController","TimelineDrag","Style","Vector","$","copyProperties","cx","ge"],function(a,b,c,d,e,f){var g=b('Button'),h=b('CSS'),i=b('DOM'),j=b('HTML'),k=b('Parent'),l=b('DOMScroll'),m=b('TimelineController'),n=b('TimelineDrag'),o=b('Style'),p=b('Vector'),q=b('$'),r=b('copyProperties'),s=b('cx'),t=b('ge');function u(v,w,x){this.root=q('fbProfileCover');if(typeof w==='object'){this._coverHeight=w.cover_height;this._coverWidth=w.cover_width;this.previewing=w.previewing;this._isLegacy=false;}else{this._isLegacy=true;this._coverHeight=w;this.previewing=x;}this._parentSection=k.byClass(this.root,'fbTimelineSection');this.cover=i.find(this.root,'.cover');u.instance=this;this.editing=false;if(!this._parentSection)this._parentSection=k.byClass(this.root,'fbEventHeader');if(this.previewing){this.editMode();this.updateCoverImage(this.previewing);}else if(this.cover.getAttribute('data-collapse'))this._expandCover(parseInt(this.cover.getAttribute('data-collapse'),10));m.register(m.COVER,this);}u.instance=null;u.getInstance=function(){return u.instance;};r(u.prototype,{showLoadingIndicator:function(){var v=t('fbCoverImageContainer');if(v)h.addClass(v,'opaquedLoading');},hideLoadingIndicator:function(){var v=t('fbCoverImageContainer');if(v)h.removeClass(v,'opaquedLoading');},isCoverImageVerticalFlow:function(v){return !(v.style.height);},editMode:function(){g.setEnabled(i.find(this.root,'label.cancelButton'),true);g.setEnabled(i.find(this.root,'label.saveButton'),true);this.hideLoadingIndicator();this._coverImage=i.scry(this.root,'.coverImage')[0];var v=i.scry(this._coverImage,'.coverWrap')[0];if(v){var w=i.find(v,'.coverPhotoImg');this._originalIsVertical=this.isCoverImageVerticalFlow(w);this._originalOffset=o.get(w,this._originalIsVertical?'top':'left');}h.addClass(this._parentSection,'fbEditCover');l.scrollTo(this.root);if(this.previewing){i.remove(this._coverImage);h.show(this._coverImage);}var x=i.scry(this._coverImage,'.coverPhotoImg')[0];if(x)this._createDragger();this.editing=true;},_expandCover:function(v){v-=1;this.cover.style.marginTop='0px';if(v!=p.getScrollPosition().y){var w=p.getViewportDimensions().y,x=p.getDocumentDimensions().y,y=w+v;if(x<=y)o.set(q('pagelet_timeline_main_column'),'min-height',y+'px');window.scrollBy(0,v);m.coverHasExpanded(v);}},_exitEditMode:function(){if(this._timelineDrag){this._timelineDrag.destroy();this._timelineDrag=null;}i.find(this.root,'input.hiddenPhotoID').value=null;i.find(this.root,'input.hiddenVideoID').value=null;g.setEnabled(i.find(this.root,'label.cancelButton'),false);g.setEnabled(i.find(this.root,'label.saveButton'),false);h.removeClass(this._parentSection,'fbEditCover');this.hideLoadingIndicator();this.previewing=false;},_createDragger:function(v){var w;if(this._isLegacy){w=i.find(this.root,'input.photoOffsetInput');this._originalIsVertical=true;}else{var x=v===undefined?this._originalIsVertical:v;w=x?i.find(this.root,'input.photoOffsetYInput'):i.find(this.root,'input.photoOffsetXInput');}this._timelineDrag=new n(i.find(this.root,'.coverImage .coverPhotoImg'),w,{height:this._coverHeight,width:this._coverWidth,listenOn:this.cover,vertical:x,killClicks:true});},updateCoverImage:function(v,w,x){this.videoID=x;if(w)this.editMode();i.find(this.root,'input.hiddenPhotoID').value=v;i.find(this.root,'input.hiddenVideoID').value=x||null;g.setEnabled(i.find(this.root,'label.saveButton'),true);if(w)i.replace(i.find(this.root,'.coverImage'),j(w));var y=i.find(i.find(this.root,'.coverImage'),'.coverPhotoImg'),z=this.isCoverImageVerticalFlow(y),aa;if(this._isLegacy){aa=i.find(this.root,'input.photoOffsetInput');}else aa=z?i.find(this.root,'input.photoOffsetYInput'):i.find(this.root,'input.photoOffsetXInput');if(this._timelineDrag){this._timelineDrag.setPicture(y,{offsetInput:aa,vertical:z});}else this._createDragger(z);},cancelUpdate:function(){i.remove(i.scry(this.root,'.coverImage')[0]);i.prependContent(this.cover,this._coverImage);if(this._originalOffset!==undefined)o.set(i.find(this._coverImage,'.coverPhotoImg'),this._originalIsVertical?'top':'left',this._originalOffset);this._exitEditMode();},saveComplete:function(){this._coverImage=i.scry(this.root,'.coverImage')[0];var v=k.byClass(this.root,'fbTimelineTopSectionBase');v&&h.removeClass(v,"_6_5");this._exitEditMode();},isInEditMode:function(){return this.editing;}});e.exports=u;});
__d("TimelineCoverDisclaimer",["Dialog"],function(a,b,c,d,e,f){var g=b('Dialog');function h(i,j,k){if(h.displayed===undefined){h.displayed=true;}else return;new g().setModal(true).setTitle(i).setBody(j).setButtonsMessage(k).setButtons(g.OK).show();}e.exports=h;});
__d("legacy:TimelineCoverDisclaimer",["TimelineCoverDisclaimer"],function(a,b,c,d){a.TimelineCoverDisclaimer=b('TimelineCoverDisclaimer');},3);
__d("TimelineCurationControl",["function-extensions","CSS","Parent","Selector"],function(a,b,c,d,e,f){b('function-extensions');var g=b('CSS'),h=b('Parent'),i=b('Selector');i.subscribe('open',function(j,k){var l=k.selector,m=k.clone||l,n=h.byClass(m,'fbTimelineCurationControl');if(n){g.addClass(n,'editControlsMenuOpen');var o=i.subscribe('close',function(p,q){if(q.selector==l){i.unsubscribe(o);g.removeClass.curry(n,'editControlsMenuOpen').defer();}});}});});
__d("TimelineProfilePic",["Arbiter","CSS","Dialog","DOM","HTML","Run","$","ge","copyProperties"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('Dialog'),j=b('DOM'),k=b('HTML'),l=b('Run'),m=b('$'),n=b('ge'),o=b('copyProperties');function p(q,r,s,t){p.destroyInstance();p._instance=this;this.leavingMessage=r;this.elemID=s||'fbProfileCover';this.elemClass=t||'.profilePicThumb';this._arbiterTokens=[g.subscribe(q.LOADING,this.startLoading.bind(this)),g.subscribe(q.SUCCESS,this.onUploadSuccess.bind(this))];l.onBeforeUnload(this.onBeforeUnload.bind(this));l.onLeave(this.destroy.bind(this));}o(p,{_instance:null,destroyInstance:function(){this._instance&&this._instance.destroy();}});o(p.prototype,{_setLoadingIndicator:function(q){this._loading=q;h.conditionClass(j.find(m(this.elemID),this.elemClass),'profilePicLoading',q);},destroy:function(){this._arbiterTokens.forEach(function(q){q.unsubscribe();});this._arbiterTokens=[];p._instance=null;},startLoading:function(q,r){this._setLoadingIndicator(r.isLoading);},onUploadSuccess:function(q,r){this._setLoadingIndicator(false);var s=i.getCurrent();if(s)s.hide();j.replace(j.find(m(this.elemID),this.elemClass),k(r.newPic));if(typeof(r.profileId)!==undefined&&typeof(r.headerPicURL)!==undefined){var t=n('profile_pic_header_'+r.profileId);if(t)t.src=r.headerPicURL;}if(n('fbProfilePicSelector'))h.removeClass(m('fbProfilePicSelector'),'fbTimelineNullProfilePicSelector');},onBeforeUnload:function(){if(p._instance===this&&this._loading)return this.leavingMessage;}});e.exports=p;});
__d("TimelineUnitSelector",["DOMQuery"],function(a,b,c,d,e,f){var g=b('DOMQuery'),h={getUnitsWithTime:function(i){return g.scry(i,'div.timelineUnitContainer').filter(function(j){return (j.parentNode.parentNode===i&&j.getAttribute('data-time'));});}};e.exports=h;});
__d("TimelineComposerUtilities",["Event","Arbiter","Bootloader","CSS","DOM","DOMQuery","Parent","TimelineUnitSelector","Vector","cx","csx"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Arbiter'),i=b('Bootloader'),j=b('CSS'),k=b('DOM'),l=b('DOMQuery'),m=b('Parent'),n=b('TimelineUnitSelector'),o=b('Vector'),p=b('cx'),q=b('csx'),r=86400*31,s=86400000,t={listenToSetEstimatedDate:function(u,v){return h.subscribe('ComposerXTimelineTagger/init',function(w,x){if(l.contains(u,x.datePickerElement)){t.setEstimatedDate(x.datePickerInstance,v());x.composerTimelineTagger.switchToTagger('date');}});},listenToSetEstimatedDateOld:function(u,v){return h.subscribe('TimelineBackdatedComposerTagger/initialized',function(event,w){if(w.composer===u)w.date_picker.subscribe('initialized',function(x,y){t.setEstimatedDate(y,v());});});},listenToPublish:function(u,v){if(u.root)u=u.root;return h.subscribe('composer/publish',function(event,w){if(w.composer_id===u.id)i.loadModules(['TimelineStoryPublisher'],function(x){x.publish(w);v&&v();});});},listenToAnotherComposerOpen:function(u,v){return h.subscribe('composer/mutate',function(w,x){if(x!==u)v();});},listenToCancel:function(u,v){return g.listen(u,'click',function(event){if(m.byClass(event.getTarget(),"_306"))v();});},listenToCancelOld:function(u,v){return g.listen(u,'click',function(event){m.byClass(event.getTarget(),'cancelBtn')&&v();});},hidePlaceIfAttachmentsTooTall:function(u){var v=l.find(u,"._2_4"),w=o.getElementDimensions(v).y;if(w>50)j.hide(l.find(v,"._mg"));},hidePlaceIfAttachmentsTooTallOld:function(u){var v=k.find(u,'ul.fbTimelineComposerAttachments'),w=o.getElementDimensions(v).y;if(w>50){var x=m.byTag(k.scry(v,'span.placeAttachment')[0],'li');x&&j.hide(x);}},setEstimatedDate:function(u,v){var w,x;if(v&&j.hasClass(v,'fbTimelineCapsule')){w=v.getAttribute('data-start');x=v.getAttribute('data-end');if(w&&x){var y=new Date(x*1000);if(x-w>2*r){u.setDate(y.getFullYear());}else u.setDate(y.getFullYear(),y.getMonth()+1);}return;}var z=m.byClass(v,'fbTimelineCapsule');if(z){w=z.getAttribute('data-start');x=z.getAttribute('data-end');var aa=o.getElementPosition(v).y,ba=[x,null],ca=[w,null],da=n.getUnitsWithTime(z);for(var ea=0;ea<da.length;ea++){var fa=da[ea],ga=k.scry(fa.parentNode,'.spinePointer')[0];if(!ga)continue;var ha=o.getElementPosition(ga).y;if(ha<=aa){if(!ba[1]||ha>ba[1])ba=[fa.getAttribute('data-time'),ha];}else if(!ca[1]||ha<ca[1])ca=[fa.getAttribute('data-time'),ha];}if(ba[0]!==null&&ca[0]!==null){var ia=Math.round((parseInt(ba[0],10)+parseInt(ca[0],10))/2)*1000;ia=Math.min(new Date()-s,ia);u.setDateWithTimestamp(ia);}}},showMLEFlyout:function(u){var v=k.scry(document,'a.fbTimelineSpine').length===0,w=function(x){x.showMLEFlyout(u);};if(v){i.loadModules(['TimelineSpinelessComposer'],w);}else i.loadModules(['TimelineComposer'],w);}};e.exports=t;});
__d("TimelineBackdatedComposer",["Arbiter","Bootloader","CSS","DOM","LayerHideOnBlur","Run","TimelineComposerUtilities","TimelineNavigation"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Bootloader'),i=b('CSS'),j=b('DOM'),k=b('LayerHideOnBlur'),l=b('Run'),m=b('TimelineComposerUtilities'),n=b('TimelineNavigation'),o;function p(){q();r();}function q(){o.hide();}function r(){h.loadModules(['TimelineMLE'],function(t){var u=t.getFlyout();if(u&&i.hasClass(u.getContext(),'backdatedDot'))t.hideFlyout();});}var s={init:function(t,u){o=u;var v=[m.listenToPublish(t,p),m.listenToAnotherComposerOpen(t,p),m.listenToSetEstimatedDateOld(t,o.getContext.bind(o)),t.subscribeToMutate(function(){var x=!j.scry(t.root,'.cancelBtn')[0]||j.scry(t.root,'.attachmentLifeEvents')[0];if(x){o.enableBehavior(k);}else o.disableBehavior(k);}),g.subscribe('TimelineMLE/mleFlyoutShown',function(x,y){if(i.hasClass(y.getContext(),'backdatedDot')){q();}else p();}),g.subscribe(n.UPDATE_PAGE,p)],w=m.listenToCancelOld(o.getContent(),p);l.onLeave(function(){v.forEach(g.unsubscribe.bind(g));v=[];w.remove();w=null;});g.inform('TimelineBackdatedComposer/initialized');},getFlyout:function(){return o;}};e.exports=a.TimelineBackdatedComposer||s;});
__d("TimelineSpine",["Event","Arbiter","AsyncRequest","Bootloader","Composer","ComposerXController","CSS","DOM","Layer","LayerHideOnBlur","Parent","Run","TimelineBackdatedComposer","TimelineComposerUtilities","copyProperties"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Arbiter'),i=b('AsyncRequest'),j=b('Bootloader'),k=b('Composer'),l=b('ComposerXController'),m=b('CSS'),n=b('DOM'),o=b('Layer'),p=b('LayerHideOnBlur'),q=b('Parent'),r=b('Run'),s=b('TimelineBackdatedComposer'),t=b('TimelineComposerUtilities'),u=b('copyProperties');function v(){}u(v,{OFFSET_Y:12,composerFlyout:null,composerRoot:null,mleFlyout:null,dot:null,loadComposerFlyoutCalled:false,showComposerFlyout:function(w){var x=v.composerFlyout;if(!x){v.loadComposerFlyout(w);v.showComposerFlyoutOnLoad=true;return;}if(v.composerRoot){l.reset(v.composerRoot);t.hidePlaceIfAttachmentsTooTall(v.composerRoot);}else{var y=n.scry(x.getContent(),'div.fbTimelineBackdatedComposer')[0],z=k.getInstance(y);if(z){z.reset();m.removeClass(z.root,'uiComposerOpen');}t.hidePlaceIfAttachmentsTooTallOld(y);}x.enableBehavior(p).setContext(v.dot).updatePosition();x.show();},loadComposerFlyout:function(w){if(v.loadComposerFlyoutCalled||v.composerFlyout)return;v.loadComposerFlyoutCalled=true;r.onLeave(function(){v.loadComposerFlyoutCalled=false;v.composerFlyout=null;v.composerRoot=null;}.bind(this));new i().setURI('/ajax/timeline/backdated_composer.php').setData({targetid:w}).setRelativeTo(v.dot||document.body).send();var x=h.subscribe('TimelineBackdatedComposer/initialized',function(y,z){if(z){v.composerFlyout=z.getFlyout();v.composerRoot=z.getComposerRoot();}else v.composerFlyout=s.getFlyout();if(v.showComposerFlyoutOnLoad)v.showComposerFlyout(w);v._handleComposerFlyoutDismissed();x.unsubscribe();});},showMLEFlyout:function(w){v.mleFlyout=w;w.setContext(v.dot).show();v.composerFlyout.hide();},_handleComposerFlyoutDismissed:function(){var w=o.subscribe('hide',function(x,y){if(v.dot&&y.getContext)if(y.getContext()===v.dot&&!v.mleFlyout){v._hideDot();}else if(y===v.mleFlyout){v.mleFlyout=null;v._hideDot();}});r.onLeave(function(){o.unsubscribe(w);}.bind(this));},_hideDot:function(){n.remove(v.dot);v.dot=null;}});u(v.prototype,{init:function(w,x){this._spine=w;this._plus=n.find(w,'.spineHoverPlus');this._capsule=q.byClass(w,'fbTimelineCapsule');this._targetid=x;var y=[g.listen(w,'mouseenter',function(event){v.loadComposerFlyout(this._targetid);this._spineHeight=w.offsetHeight;}.bind(this)),g.listen(w,'mousemove',this._mouseMoved.bind(this)),g.listen(w,'click',this._spineClicked.bind(this))];m.addClass(this._plus,'spineHoverPlusActive');r.onLeave(function(){while(y.length)y.pop().remove();}.bind(this));},_mouseMoved:function(event){var w=event.offsetY||event.layerY,x=event.getTarget();if(x!==this._spine)w=x.offsetTop+w;w=Math.min(Math.max(w-v.OFFSET_Y,0),this._spineHeight);this._plus.style.top=w+'px';},_spineClicked:function(event){if(v.mleFlyout){j.loadModules(['TimelineMLE'],function(w){w.hideFlyout();});return;}v.dot&&n.remove(v.dot);v.dot=n.create('i',{className:'backdatedDot'});v.dot.style.top=(this._plus.offsetTop-1)+'px';n.appendContent(this._spine,v.dot);event.stop();v.showComposerFlyout(this._targetid);}});e.exports=a.TimelineSpine||v;});
__d("legacy:TimelineSpine",["TimelineSpine"],function(a,b,c,d){a.TimelineSpine=b('TimelineSpine');},3);
__d("timeline-cover-dragdrop-edit",["SinglePictureUploadTarget","TimelineCover"],function(a,b,c,d,e,f){var g=b('SinglePictureUploadTarget'),h=b('TimelineCover'),i=function(){var m=h.getInstance();m.hideLoadingIndicator();},j=function(m){var n=h.getInstance(),o=m.id,p=m.photo_html;n.updateCoverImage(o,p);},k=function(m){h.getInstance().showLoadingIndicator();},l=function(m,n,o,p){new g(m,n).setMaximumDimensions(o,p).setPreprocessCallback(k).setOncompleteCallback(i).setAfterSuccessCallback(j).activate();};f.initialize_timeline_cover_drop_target=l;});
__d("TimelineCapsule",["Arbiter","CSS","DataStore","DOM","DOMQuery","DOMScroll","Parent","TimelineConstants","TimelineLegacySections","UserAgent","Vector","$","createArrayFrom","csx","isEmpty","queryThenMutateDOM","requestAnimationFrame"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('CSS'),i=b('DataStore'),j=b('DOM'),k=b('DOMQuery'),l=b('DOMScroll'),m=b('Parent'),n=b('TimelineConstants'),o=b('TimelineLegacySections'),p=b('UserAgent'),q=b('Vector'),r=b('$'),s=b('createArrayFrom'),t=b('csx'),u=b('isEmpty'),v=b('queryThenMutateDOM'),w=b('requestAnimationFrame'),x=(function(){var y=45,z=15,aa='use',ba='update',ca={},da={};function ea(ra){return h.hasClass(ra,'fbTimelineBalancer');}function fa(ra){return ra.getAttribute('data-spine');}function ga(ra){return h.hasClass(ra,'placeholderUnit');}function ha(ra,sa){if(sa)return (i.get(n.DS_SIDEORG,ra.id)||ra.getAttribute('data-side'));return ra.getAttribute('data-side');}var ia=function(ra,sa){if(p.ie()<=6){ia=function(ta,ua){i.set(n.DS_SIDEORG,ta.id,ha(ta,true));ta.setAttribute('data-side',ua);h.removeClass(ta,'leftColumn');h.removeClass(ta,'rightColumn');h.addClass(ta,ua=='l'?'leftColumn':'rightColumn');};}else ia=function(ta,ua){i.set(n.DS_SIDEORG,ta.id,ha(ta,true));ta.setAttribute('data-side',ua);};ia(ra,sa);};function ja(ra){return ra.getAttribute('data-size');}function ka(ra){if(h.hasClass(ra,'fbTimelineOneColumn')&&ra.prevSibling&&h.hasClass(ra.prevSibling,'fbTimelineOneColumn'))return z*2;if(h.hasClass(ra,'fbTimelineIndeterminateContent'))return 0;return z;}function la(ra,sa){var ta=0;if(h.shown(ra)&&!h.hasClass(ra,'placeholderUnit'))if(sa===aa){ta=i.get(n.DS_HEIGHT,ra.id,null);if(ta===null)ta=ra.getAttribute('data-calculatedheight');}else ta=ra.offsetHeight+ka(ra);if(sa===aa&&ta===null)ta=300;i.set(n.DS_HEIGHT,ra.id,parseInt(ta,10));}function ma(ra){var sa=i.get(n.DS_HEIGHT,ra.id,null);return sa;}function na(ra,sa){if(ja(sa)=='2'){return 0;}else if(ha(sa)=='r'){return ra+ma(sa);}else return ra-ma(sa);}function oa(ra){k.scry(ra,"._3ram").forEach(function(sa){var ta=sa.getAttribute('data-endmarker'),ua=sa.getAttribute('data-pageindex'),va=function(){if(!sa.parentNode)return;i.set(n.DS_LOADED,ra.id,ua);j.remove(sa);g.inform(n.SECTION_FULLY_LOADED,{scrubberKey:ta,pageIndex:ua,capsuleID:ra.id,childCount:ra.childNodes.length});};if(o.get(ta)){va();}else var wa=g.subscribe(n.SECTION_REGISTERED,function(xa,ya){if(ya.scrubberKey===ta){va();wa.unsubscribe();}});});g.inform('TimelineCapsule/balanced',{capsule:ra});}function pa(ra){if(u(ca[ra.id]))return;var sa=ea(ra)?ra.firstChild:ra,ta=sa.childNodes.length,ua={},va={},wa,xa=z,ya=z,za,ab=[];for(var bb=0;bb<ta;bb++){wa=sa.childNodes[bb];if(h.hasClass(wa,'fbTimelineUnit')){za=k.scry(wa,'div.timelineUnitContainer')[0];if(za)va[wa.id]=za.getAttribute('data-time');if(!ga(wa)&&h.shown(wa)){if(ja(wa)=='2'){ua[wa.id]=Math.max(xa,ya);xa=ya=ua[wa.id]+ma(wa);}else if(ha(wa)=='r'){ua[wa.id]=ya;ya+=ma(wa);}else{ua[wa.id]=xa;xa+=ma(wa);}if(ha(wa,true)=='l'||ja(wa)=='2')ab.push(wa.id);}}}for(bb=0;bb<ab.length-1;++bb){var cb=ab[bb],db=ab[bb+1],eb=ua[cb]+y,fb=ua[db];for(var gb in ca[ra.id]){if(eb>fb)break;var hb=ca[ra.id][gb];if(h.shown(hb))continue;if(va[gb]<=va[cb]&&va[gb]>va[db]){hb.style.top=eb+"px";eb+=y;h.show(hb);}}}}function qa(ra,sa){var ta=m.byAttribute(ra,'data-size');if(ta){if(h.hasClass(ra.parentNode,'timelineReportContent')){sa(ra);}else sa(ta);x.balanceCapsule(m.byClass(ta,'fbTimelineCapsule'));}}return {removeUnit:function(ra){qa(ra,function(sa){j.remove(sa);});},hideUnit:function(ra){qa(ra,function(sa){h.addClass(sa,'fbTimelineColumnHidden');});},undoHideUnit:function(ra,sa){j.remove(m.byClass(sa,'hiddenText'));qa(ra,function(ta){h.removeClass(ta,'fbTimelineColumnHidden');});},unplacehold:function(ra){var sa=r(ra);sa.style.top=null;h.removeClass(sa,'visiblePlaceholder');h.removeClass(sa,'placeholder');var ta=m.byClass(sa,'fbTimelineCapsule');delete ca[ta.id][ra];x.balanceCapsule(ta);},scrollToCapsule:function(ra){if(!da.hasOwnProperty(ra.id)){var sa=q.getElementPosition(ra.parentNode);l.scrollTo(new q(q.getScrollPosition().x,sa.y-n.SUBSECTION_SCROLL_TO_OFFSET,'document'));da[ra.id]=true;}},balanceCapsuleFromChild:function(ra,sa){x.balanceCapsule(m.byClass(ra,'fbTimelineCapsule'),sa);},balanceCapsuleDeferred:function(ra,sa){x.balanceCapsule.curry(ra,sa).defer();},balanceCapsule:function(ra,sa){if(!ra||!ra.childNodes)return;var ta=0,ua,va=document.createDocumentFragment(),wa=[],xa=[],ya=[],za=false,ab=sa&&sa.heights_action;if(sa&&sa.tail_balance)i.set(n.DS_TAILBALANCE,ra.id,sa.tail_balance);if(ab!==ba&&(p.chrome()||p.webkit()))h.toggleClass(ra,'webkitFix');for(var bb=0;bb<ra.childNodes.length;bb++){ua=ra.childNodes[bb];if(fa(ua)){continue;}else if(ea(ua)){s(ua.firstChild.childNodes).forEach(function(jb){la(jb,ab);});continue;}la(ua,ab);if(ha(ua,true)=='r'){xa.push(ua);}else wa.push(ua);ya.push(ua);if(ja(ua)!='2')if((ta>0&&ha(ua)=='r')||(ta<0&&ha(ua)=='l'))za=true;ta=na(ta,ua);}var cb=[],db=[],eb=[];k.scry(ra,'li.fbTimelineBalancer').forEach(function(jb){var kb=s(jb.firstChild.childNodes);if(jb.getAttribute('data-nonunits')){eb=eb.concat(kb);}else if(ha(jb)=='left'){cb=cb.concat(kb);}else if(ha(jb)=='right')db=db.concat(kb);});if(za){ra.style.minHeight=ra.offsetHeight;wa.forEach(function(jb){if(ja(jb)!='2')ia(jb,'l');});xa.forEach(function(jb){if(ja(jb)!='2')ia(jb,'r');});var fb=j.create('li',{className:'fbTimelineBalancer'},j.create('ol',null,wa));fb.setAttribute('data-side','left');j.prependContent(ra,fb);cb=wa.concat(cb);var gb=j.create('li',{className:'fbTimelineBalancer'},j.create('ol',null,xa));gb.setAttribute('data-side','right');j.prependContent(ra,gb);db=xa.concat(db);ta=0;}while(eb.length)va.appendChild(eb.shift());while((ta>=0&&cb.length)||(ta<0&&db.length)){if(ta>=0){ua=cb.shift();}else ua=db.shift();va.appendChild(ua);ta=na(ta,ua);}ra.appendChild(va);k.scry(ra,'li.fbTimelineBalancer').forEach(function(jb){if(!jb.firstChild.childNodes.length)j.remove(jb);});var hb=(sa&&sa.tail_balance)||i.get(n.DS_TAILBALANCE,ra.id);if(hb)ta=x.tailBalance(ra,ta,hb);if(za){ya.forEach(function(jb){if(jb.parentNode!==ra){ra.appendChild(jb);ta=na(ta,jb);}});ra.style.minHeight=null;}var ib=m.byClass(ra,'fbTimelineSection');if(ib)i.set(n.DS_COLUMN_HEIGHT_DIFFERENTIAL,ib.id,ta);ca[ra.id]={};k.scry(ra,'li.placeholderUnit').forEach(function(jb){ca[ra.id][jb.id]=jb;});pa(ra);oa(ra);if(ab===aa){sa.heights_action=ba;w(function(){w(x.balanceCapsule.curry(ra,sa));});}},tailBalance:function(ra,sa,ta){if(!ra)return sa;var ua=[],va=[],wa=[],xa=[];k.scry(ra,'li.fbTimelineBalancer').forEach(function(za){var ab=s(za.firstChild.childNodes);if(za.getAttribute('data-nonunits')){xa=xa.concat(ab);}else if(ha(za)=='left'){va=va.concat(ab);}else if(ha(za)=='right')wa=wa.concat(ab);ua=ua.concat(ab);});if((ta==n.FIXED_SIDE_RIGHT&&va.length)||(ta==n.FIXED_SIDE_LEFT&&wa.length))return sa;var ya=document.createDocumentFragment();if(ua)while(ua.length){if(ta!=n.FIXED_SIDE_NONE)if(ja(ua[0])!='2')if(sa>=0){ia(ua[0],'l');}else ia(ua[0],'r');sa=na(sa,ua[0]);ya.appendChild(ua.shift());}ra.appendChild(ya);k.scry(ra,'li.fbTimelineBalancer').forEach(function(za){if(!za.firstChild.childNodes.length)j.remove(za);});return sa;},loadTwoColumnUnits:function(ra){var sa=r(ra);v(function(){var ta=m.byClass(sa,'fbTimelineSection');if(ta){var ua=k.find(sa,"._3rbf"),va=k.find(sa,"._3rbh"),wa=va.offsetHeight-ua.offsetHeight;i.set(n.DS_COLUMN_HEIGHT_DIFFERENTIAL,ta.id,wa);}},oa.curry(sa));}};})();e.exports=a.TimelineCapsule||x;});
__d("TimelineCapsuleUtilities",["CSS"],function(a,b,c,d,e,f){var g=b('CSS'),h={setFirstUnit:function(i){var j=true;for(var k=0;k<i.childNodes.length;++k){var l=i.childNodes[k];if(l.id.indexOf('tl_unit_')===0)if(j){j=false;g.addClass(l,'firstUnit');}else{g.removeClass(l,'firstUnit');break;}}}};e.exports=h;});
__d("TimelineComposer",["Arbiter","Bootloader","CSS","DOM","Parent","Run","TimelineCapsule","TimelineCapsuleUtilities","TimelineComposerUtilities","$","cx"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Bootloader'),i=b('CSS'),j=b('DOM'),k=b('Parent'),l=b('Run'),m=b('TimelineCapsule'),n=b('TimelineCapsuleUtilities'),o=b('TimelineComposerUtilities'),p=b('$'),q=b('cx'),r;function s(x){if(x.isScheduledPost||x.isOGPost)return;if(!x.streamStory){window.location.reload();return;}if(x.backdatedTime){h.loadModules(['TimelineStoryPublisher'],function(z){z.publish(x);});return;}var y=w.renderCapsuleBasedStory(r,x.streamStory);g.inform('TimelineComposer/on_after_publish',y,g.BEHAVIOR_PERSISTENT);}function t(){var x=k.byClass(r,'fbTimelineTwoColumn');return j.find(x,'.spinePointer');}function u(x){var y=v();i.show(y);var z=x.subscribe('hide',function(){i.hide(y);x.unsubscribe(z);});}function v(){var x=k.byClass(r,'fbTimelineTwoColumn'),y=j.scry(x,'div.composerVeil');if(y.length!==1)y=j.appendContent(x,j.create('div',{className:'composerVeil hidden_elem'}));return y[0];}var w={init:function(x){r=p(x);var y=g.subscribe('composer/publish',function(event,z){if(z.composer_id===r.id)s(z);});l.onLeave(y.unsubscribe.bind(y));if(i.hasClass(r,"_mj")){o.hidePlaceIfAttachmentsTooTall(r);}else o.hidePlaceIfAttachmentsTooTallOld(r);},showMLEFlyout:function(x){x.setContext(t()).show();u(x);},renderCapsuleBasedStory:function(x,y){var z=k.byClass(x,'fbTimelineCapsule');if(!z)return;var aa=k.byClass(x,'timelineUnitContainer').parentNode;if(aa.nextSibling.getAttribute('data-spine'))aa=aa.nextSibling;var ba=j.insertAfter(aa,y)[0];h.loadModules(['Animation'],function(ca){new ca(ba.firstChild).from('backgroundColor','#fff8dd').to('backgroundColor','#fff').duration(2000).ease(ca.ease.both).go();});n.setFirstUnit(z);m.balanceCapsule(z);return ba;}};e.exports=a.TimelineComposer||w;});
__d("TimelineSmartInsert",["Run","UserAgent","Vector"],function(a,b,c,d,e,f){var g=b('Run'),h=b('UserAgent'),i=b('Vector'),j=false,k=false;function l(){if(k)return;g.onLeave(m);k=true;}function m(){j=false;k=false;}var n={BUFFER:100,run:function(o,p){l();if(!j||h.ie()<=8){p();return;}var q=o.offsetHeight;p();var r=o.offsetHeight;if(r-q!==0&&i.getElementPosition(o).y+q<i.getScrollPosition().y+n.BUFFER)window.scrollBy(0,r-q);},enable:function(){j=true;}};e.exports=n;});
__d("TimelineContentLoader",["Event","function-extensions","Arbiter","CSS","DOM","DOMScroll","OnVisible","ScrollingPager","TimelineConstants","TimelineController","TimelineLegacySections","TimelineSmartInsert","TimelineURI","UIPagelet","UserAgent","Vector","$","arrayContains","copyProperties","createArrayFrom","csx","debounce","ge","startsWith","tx","userAction"],function(a,b,c,d,e,f){var g=b('Event');b('function-extensions');var h=b('Arbiter'),i=b('CSS'),j=b('DOM'),k=b('DOMScroll'),l=b('OnVisible'),m=b('ScrollingPager'),n=b('TimelineConstants'),o=b('TimelineController'),p=b('TimelineLegacySections'),q=b('TimelineSmartInsert'),r=b('TimelineURI'),s=b('UIPagelet'),t=b('UserAgent'),u=b('Vector'),v=b('$'),w=b('arrayContains'),x=b('copyProperties'),y=b('createArrayFrom'),z=b('csx'),aa=b('debounce'),ba=b('ge'),ca=b('startsWith'),da=b('tx'),ea=b('userAction'),fa=false,ga=false,ha,ia=null,ja={},ka=[],la=[],ma=[],na={},oa={},pa={},qa={},ra=null,sa=null,ta=false,ua=null;function va(eb,fb,gb,hb,ib){this.node=eb;this.loaded=hb;this.canScrollLoad=true;this.canUnload=fb!=db.RECENT;this.scrubberKey=fb;this.historicUnitCount=ib;this._pageletLoadData=gb;this._expandPageletLoadData={};this.rightColumnFinished=false;}x(va.prototype,{load:function(eb){if(this.loaded)return;var fb=this._pageletLoadData;h.inform(n.SECTION_LOADING,{data:fb,scrubberKey:this.scrubberKey});this.loaded=true;i.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');i.removeClass(this.node,'fbTimelineTimePeriodSuppressed');var gb='ProfileTimelineSectionPagelet',hb=this.scrubberKey==db.WAY_BACK;if(hb)gb='ProfileTimelineRemainingYearsPagelet';fb.time_cutoff=db.getTimeCutoff();fb.highlight_unit_data=eb;fb.parent_key=this.parentKey;fb.force_no_friend_activity=ta;i.addClass(this.node,'fbTimelineSectionLoading');if(fb.combine_sections)i.addClass(this.node,'combinedSections');if(this.canUnload&&ga){var ib=this.node.firstChild.cloneNode(true);i.hide(ib);j.insertAfter(this.node,ib);}else this.canScrollLoad=false;var jb=fb.combine_sections&&hb;pa[this.scrubberKey]=s.loadFromEndpoint(gb,jb?fb.unit_container_id+'_left':this.node.id,fb,{usePipe:true,jsNonblock:true,constHeight:true,append:jb});cb(this.scrubberKey);},preload:function(){i.addClass(this.node,'fbTimelineTimePeriodSuppressed');i.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');var eb=j.find(this.node,'span.sectionLabel');if(eb.getAttribute('data-original-label')){j.setContent(eb,eb.getAttribute('data-original-label'));eb.removeAttribute('data-original-label');}},unload:function(){if(!this.loaded||!this.canUnload)return;this.loaded=false;pa[this.scrubberKey]&&pa[this.scrubberKey].cancel();i.addClass(this.node,'fbTimelineTimePeriodUnexpanded');i.removeClass(this.node,'fbTimelineTimePeriodSuppressed');if(this.node.nextSibling&&i.hasClass(this.node.nextSibling,'fbTimelineSection')){j.setContent(this.node,this.node.nextSibling);i.show(this.node.firstChild);}else j.empty(this.node);this.deactivateScrollLoad();},activateScrollLoad:function(){this.canScrollLoad=true;i.removeClass(this.node,'fbTimelineTimePeriodSuppressed');i.addClass(this.node,'fbTimelineTimePeriodUnexpanded');oa[this.scrubberKey]&&oa[this.scrubberKey].reset();},deactivateScrollLoad:function(){if(!this.loaded){this.canScrollLoad=false;i.removeClass(this.node,'fbTimelineTimePeriodUnexpanded');i.addClass(this.node,'fbTimelineTimePeriodSuppressed');oa[this.scrubberKey]&&oa[this.scrubberKey].remove();}},setExpandLoadData:function(eb){this._expandPageletLoadData=eb;return this;},appendData:function(eb){x(this._pageleLoadData,eb);return this;},expandSubSections:function(){if(this.subSections.length)db.navigateToSection(this.subSections[0].scrubberKey);},expand:function(eb){if(!this.loaded)return;sa.add_event('expand_'+this.scrubberKey);var fb=j.find(this.node,'.fbTimelineSectionExpander');i.addClass(fb.firstChild,'async_saving');eb&&i.addClass(eb,'async_saving');this._expandPageletLoadData.time_cutoff=db.getTimeCutoff();db.navigateToSection(this.scrubberKey);j.scry(this.node,'.fbTimelineCapsule').forEach(j.remove);this._expandPageletLoadData.new_expand=true;pa[this.scrubberKey]&&pa[this.scrubberKey].cancel();pa[this.scrubberKey]=s.loadFromEndpoint('ProfileTimelineSectionPagelet',fb.id,this._expandPageletLoadData,{usePipe:true,jsNonblock:true,constHeight:true});},isPermalinkPeriod:function(){return this._pageletLoadData.is_permalink_period;}});function wa(){if(fa)return;o.register(o.CONTENT,db);sa=ea('timeline').uai('init','scrubber',false);fa=true;if(t.ie()<=7)ga=true;}var xa=aa(function(eb,fb,gb){var hb=p.get(eb).historicUnitCount;fb-=hb;gb-=1;if(hb==-1||gb<=0||fb<0)return;var ib=db.getNextSectionKey(eb);if(ib){p.get(ib).load();xa(ib,fb,gb);}},500);function ya(eb,fb,gb,hb){var ib=db.getNextSectionKey(fb);if(ib){oa[ib]=new l(eb,za.curry(ib,eb),false,gb||1000);}else if(fb!==db.WAY_BACK){hb=hb?hb:0;if(hb>80)return null;ya.curry(eb,fb,gb,hb+1).defer(250);}}function za(eb,fb){var gb=p.get(eb);if(gb&&gb.canScrollLoad){sa.add_event("scroll_load_"+eb);if(ga){gb.preload();}else{gb.load();if(ua)xa(eb,ua.required_units,ua.max_parallelism);}fb&&j.remove(fb);}}function ab(){var eb,fb,gb=false;for(var hb=0;hb<ka.length;hb++){var ib=ka[hb];if(!ib)continue;var jb=p.get(ib);if(jb&&(jb.canScrollLoad||jb.loaded)){if(!jb.loaded){i.removeClass(jb.node,'fbTimelineTimePeriodSuppressed');i.addClass(jb.node,'fbTimelineTimePeriodUnexpanded');}if(eb&&fb){bb(eb,fb);if(gb)eb.deactivateScrollLoad();gb=true;}eb=null;fb=null;continue;}else if(eb){fb=jb;jb.deactivateScrollLoad();}else{eb=jb;if(gb)jb.activateScrollLoad();}i.removeClass(jb.node,'fbTimelineTimePeriodSuppressed');i.addClass(jb.node,'fbTimelineTimePeriodUnexpanded');}}function bb(eb,fb){i.removeClass(fb.node,'fbTimelineTimePeriodUnexpanded');i.addClass(fb.node,'fbTimelineTimePeriodSuppressed');var gb=j.find(eb.node,'span.sectionLabel'),hb=j.find(fb.node,'span.sectionLabel');if(!hb.getAttribute('data-original-label'))hb.setAttribute('data-original-label',j.getText(hb));if(gb.getAttribute('data-month')&&hb.getAttribute('data-month')&&gb.getAttribute('data-year')==hb.getAttribute('data-year')){j.setContent(hb,da._("Show {month1} - {month2} {year}",{month1:hb.getAttribute('data-month'),month2:gb.getAttribute('data-month'),year:gb.getAttribute('data-year')}));}else if(gb.getAttribute('data-year')!==hb.getAttribute('data-year')){j.setContent(hb,da._("Show {year1} - {year2}",{year1:hb.getAttribute('data-year'),year2:gb.getAttribute('data-year')}));}else j.setContent(hb,da._("Show {year}",{year:hb.getAttribute('data-year')}));}function cb(eb){if(ga)for(var fb=0;fb<ka.length-1;fb++){var gb=ka[fb];if(!gb)continue;if(gb!=eb){var hb=p.get(gb);if(hb.loaded&&hb.canUnload)hb.unload();}}ab();}var db={WAY_BACK:'way_back',RECENT:'recent',HEADER_SCROLL_CUTOFF:80,CURRENT_SECTION_OFFSET:150,FOOTER_HEIGHT:60,registerTimePeriod:function(eb,fb,gb,hb,ib,jb,kb){wa();if(w(ma,fb))return;if(la)x(gb,la);var lb=new va(eb,fb,gb,hb,kb);if(!ib){ka[jb]=fb;ja[fb]=true;}else{lb.parentKey=ib;p.get(ib).subSections=p.get(ib).subSections||[];p.get(ib).subSections[jb]=lb;}p.set(fb,lb);db.checkCurrentSectionChange();h.inform(n.SECTION_REGISTERED,{scrubberKey:fb});o.registerSectionKey(fb,jb);},reset:function(){for(var eb in oa)oa[eb].remove();for(var fb in pa)pa[fb]&&pa[fb].cancel();for(var gb in qa){qa[gb].unsubscribe();delete qa[gb];}ha&&ha.unsubscribe();ha=null;p.removeAll();ia=null;ja={};ka=[];la=[];ma=[];na={};oa={};pa={};ra=null;sa=null;ta=false;fa=false;},checkCurrentSectionChange:function(){var eb=db.getCurrentSection(),fb=ia&&ia.scrubberKey;if(eb&&eb.scrubberKey!==fb&&!eb.isPermalinkPeriod()){ia=eb;var gb=eb.scrubberKey,hb=eb.parentKey;if(!hb){hb=gb;gb=null;}o.sectionHasChanged(hb,gb);}},setTimeCutoff:function(eb){ra=eb;},getTimeCutoff:function(){return ra;},setParallelLoadConfig:function(eb){ua=eb;},getCurrentSection:function(){var eb={},fb=p.getAll();for(var gb in fb){var hb=fb[gb];if(!hb.loaded||na[hb.scrubberKey])continue;var ib=u.getElementPosition(hb.node,'viewport').y;if(hb.scrubberKey=='recent')ib--;if(ib<db.CURRENT_SECTION_OFFSET)eb[ib]=hb;}var jb=Math.max.apply(null,Object.keys(eb)),kb=jb==-Infinity;if(!kb){return eb[jb];}else if(ka[0])return p.get(ka[0]);return null;},capsuleForCurrentSection:function(){var eb=db.getCurrentSection();return eb&&j.scry(eb.node,'.fbTimelineCapsule')[0];},enableScrollLoad:function(eb,fb,gb,hb){eb=v(eb);var ib=j.scry(eb.parentNode,'.fbTimelineCapsule')[0];if(!ib)return;if(gb===null){ya(eb,fb,hb);}else o.runOnceWhenSectionFullyLoaded(ya.curry(eb,fb,hb),fb,gb);},enableScrollLoadOnClick:function(eb,fb,gb){eb=v(eb);g.listen(eb,'click',function(hb){hb.prevent();db.enableScrollLoad(eb,fb,null,gb);});},expandSectionOnClick:function(eb,fb){g.listen(eb,'click',function(gb){gb.prevent();p.get(fb).expand();});},expandSubSectionsOnClick:function(eb,fb){g.listen(eb,'click',function(gb){gb.prevent();p.get(fb).expandSubSections();});},getNextSectionKey:function(eb){for(var fb=0;fb<ka.length-1;fb++)if(ka[fb]==eb){while(fb<ka.length-1&&!ka[fb+1])fb++;return ka[fb+1];}var gb=p.get(eb);if(!gb||!gb.parentKey)return;var hb=p.get(gb.parentKey);if(!hb)return;for(var ib=0;ib<hb.subSections.length-1;ib++)if(hb.subSections[ib].scrubberKey==eb)return hb.subSections[ib+1].scrubberKey;},hideSection:function(eb){var fb=p.get(eb);fb&&i.hide(fb.node);var gb=o.getCurrentScrubber();if(gb){var hb=o.getCurrentScrubber().getNav(eb);hb&&i.hide(hb);}var ib=o.getCurrentStickyHeaderNav();ib&&ib.removeTimePeriod(eb);na[eb]=true;},loadSectionOnClick:function(eb,fb){g.listen(eb,'click',function(gb){gb.prevent();p.get(fb).load();});},removeSection:function(eb){for(var fb in ka)if(ka[fb]==eb){ka[fb]=null;break;}p.remove(eb);delete ja[eb];if(eb in oa){oa[eb].remove();delete oa[eb];}var gb=o.getCurrentStickyHeaderNav();gb&&gb.removeTimePeriod(eb);ma.push(eb);},removeSectionParent:function(eb){j.remove(v(eb).parentNode);},navigateToSection:function(eb,fb,gb){sa.add_event("nav_"+eb);fb=!!fb;var hb=eb,ib=p.get(eb);if(!ib)return;if(!ib.loaded){q.enable();j.scry(v('timeline_tab_content'),'.fbTimelineShowOlderSections').forEach(j.remove);}if(!ja[eb]){ib.node.style.minHeight=u.getViewportDimensions().y+'px';var jb=h.subscribe(n.SECTION_FULLY_LOADED,function(rb,sb){if(sb.scrubberKey===eb){ib.node.style.minHeight='';jb.unsubscribe();}});hb=ib.parentKey;var kb=p.get(hb).node;if(!i.hasClass(kb,'fbTimelineSectionExpanded')){k.scrollTo(kb,0);i.addClass(kb,'fbTimelineSectionExpanded');j.scry(kb,'.fbTimelineCapsule').forEach(j.remove);j.scry(kb,'div.fbTimelineSectionExpandPager').forEach(j.remove);j.scry(kb,'div.fbTimelineContentHeader').forEach(j.remove);j.scry(kb,"._5vf").forEach(function(rb){if(!rb.getAttribute('data-subsection'))j.remove(rb);});}var lb=db.getNextSectionKey(hb);if(lb&&oa[lb])oa[lb].setBuffer(0);}for(var mb=0;mb<ka.length;mb++){var nb=ka[mb];if(!nb)continue;if(nb==hb)break;p.get(nb).deactivateScrollLoad();j.scry(v('timeline_tab_content'),'.fbTimelineSectionExpandPager').forEach(function(rb){var sb=m.getInstance(rb.id);sb&&sb.removeOnVisible();});}db.adjustContentPadding();ib.load(gb);ab();var ob=u.getScrollPosition().x,pb=u.getElementPosition(ib.node).y;if(!fb){var qb=ja[eb]?n.SCROLL_TO_OFFSET:n.SUBSECTION_SCROLL_TO_OFFSET;k.scrollTo(new u(ob,pb-qb,'document'),true,false,false,function(){var rb=u.getElementPosition(ib.node).y;k.scrollTo(new u(ob,rb-qb,'document'),false);var sb=j.scry(ib.node,'h3.uiHeaderTitle')[0];if(sb){sb.tabIndex=0;sb.focus();}});}},adjustContentPadding:function(){var eb=ba('timeline_tab_content');if(!eb)return;if(o.isOneColumnMinimal())return;var fb=o.getCurrentKey()||r.TIMELINE_KEY;if(fb!==r.TIMELINE_KEY)return;var gb=ka.length-1,hb=p.get(ka[gb]);eb.style.paddingBottom=hb&&hb.loaded?null:u.getViewportDimensions().y-db.CURRENT_SECTION_OFFSET-db.HEADER_SCROLL_CUTOFF-db.FOOTER_HEIGHT+'px';},adjustContentPaddingAfterLoad:function(eb,fb){o.runOnceWhenSectionFullyLoaded(db.adjustContentPadding,eb,fb);},appendContentAfterLoad:function(eb,fb,gb){o.runOnceWhenSectionFullyLoaded(j.appendContent.curry(v(eb),fb),gb,'0');},markSectionAsLoaded:function(eb,fb,gb){o.runOnceWhenSectionFullyLoaded(function(){ba(eb)&&i.removeClass(v(eb).parentNode,'fbTimelineSectionLoading');},fb,gb);},suppressSectionsAbove:function(eb){var fb,gb;for(var hb=0;hb<ka.length;hb++){var ib=ka[hb];if(!ib)continue;fb=p.get(ib).node;gb=null;if(y(eb.parentNode.children).indexOf(eb)<=y(fb.parentNode.children).indexOf(fb)){gb=ib;break;}p.get(ib).deactivateScrollLoad();}if(gb)db.navigateToSection(gb,true);},forceNoFriendActivity:function(){ta=true;},removeDupes:function(eb){var fb=ba(eb);if(!fb)return;var gb=j.scry(fb,'li.fbTimelineUnit'),hb={};for(var ib=0;ib<gb.length;ib++){var jb=gb[ib];if(jb.id&&ca(jb.id,'tl_unit_')){var kb=jb.id.substring(8,jb.id.length),lb=(jb.getAttribute('data-unit')=='ExperienceSummaryUnit'?jb.getAttribute('data-time'):1);if(hb.hasOwnProperty(kb)&&hb[kb]==lb){jb.id='dupe_unit_'+Math.random();jb.className="hidden_elem";}else hb[kb]=lb;}}},removeLoadingState:function(eb){ba(eb)&&i.removeClass(v(eb),'fbTimelineSectionLoading');},setExpandLoadDataForSection:function(eb,fb){var gb=p.get(eb);gb&&gb.setExpandLoadData(fb);},appendSectionDataForAllSections:function(eb){la=eb;for(var fb=0;fb<ka.length-1;fb++){var gb=ka[fb];if(!gb)continue;var hb=p.get(gb);hb&&hb.appendData(eb);}},updatePagerAfterLoad:function(eb,fb,gb,hb,ib){var jb=m.getInstance(eb.firstChild.id);if(!jb){qa[eb.firstChild.id]=h.subscribe(m.REGISTERED,function(kb,lb){qa[eb.firstChild.id].unsubscribe();delete qa[eb.firstChild.id];if(lb.id===eb.firstChild.id)db.updatePagerAfterLoad(eb,fb,gb,hb,ib);});return;}o.runOnceWhenSectionFullyLoaded(function(){i.removeClass(eb,'fbTimelineHiddenPager');jb.checkBuffer();},gb,hb);if(ib)o.runOnceWhenSectionFullyLoaded(o.adjustScrollingPagerBuffer.curry(eb.firstChild.id,fb),gb,hb);},showAfterLoad:function(eb,fb,gb){o.runOnceWhenSectionFullyLoaded(function(){var hb=ba(eb);hb&&i.show(hb);},fb,gb);},repositionDialog:function(eb){h.subscribe(n.SECTION_LOADED,function(){eb.updatePosition();});},rightColumnFinished:function(eb){var fb=p.get(eb);fb.rightColumnFinished=true;}};e.exports=db;});
__d("TimelineLogging",["TimelineController","reportData"],function(a,b,c,d,e,f){var g=b('TimelineController'),h=b('reportData'),i=false,j=0,k=null,l={init:function(m){if(i)return;j=m;g.register(g.LOGGING,this);},reset:function(){i=false;j=0;k=null;},log:function(m,n){n.profile_id=j;h(m,{gt:n});},logSectionChange:function(m,n){var o={timeline_section_change:1,key:m};if(k&&m==k){o.timeline_scrubber=1;k=null;}l.log('timeline',o);},logScrubberClick:function(m){k=m;}};e.exports=l;});
__d("TimelineStar",["Event","Button","CSS","DOM","Parent","TimelineCapsule","Tooltip","URI","csx","cx","tx"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Button'),i=b('CSS'),j=b('DOM'),k=b('Parent'),l=b('TimelineCapsule'),m=b('Tooltip'),n=b('URI'),o=b('csx'),p=b('cx'),q=b('tx');function r(w){return j.scry(w,"a._5m-")[0];}var s=null,t=[];function u(w){s=s||function(){t.forEach(function(x){x.remove();});t.length=0;};t.push(w);}var v={STAR_CSS_ONLY:1,STAR_ASYNC_REQUIRED:2,ACTION_STAR:7,ACTION_UNSTAR:8,starUnitFromButton:function(w,x,y){m.set(w,"Remove from highlights");var z=k.byClass(w,'timelineUnitContainer');v.starUnit(z,x,y);},starUnit:function(w,x,y){var z=r(w);if(z){i.addClass(w,"_6q0");return;}var aa=w.parentNode;if(!y)j.setContent(aa,x);i.removeClass(aa,'fbTimelineTwoColumn');i.addClass(aa,'fbTimelineOneColumn');aa.removeAttribute('data-side');aa.setAttribute('data-size','2');m.hide();l.balanceCapsule.curry(aa.parentNode).defer();},unstarUnitFromButton:function(w,x,y){m.set(w,"Highlight");var z=k.byClass(w,'timelineUnitContainer');v.unstarUnit(z,x,y);},unstarUnit:function(w,x,y){var z=r(w);if(z){i.removeClass(w,"_6q0");return;}var aa=w.parentNode;if(!y)j.setContent(aa,x);i.removeClass(aa,'fbTimelineOneColumn');i.addClass(aa,'fbTimelineTwoColumn');aa.setAttribute('data-side','l');aa.setAttribute('data-size','1');m.hide();l.balanceCapsule.curry(aa.parentNode).defer();},listenToButton:function(w,x){if(!w)return;switch(x){case v.STAR_CSS_ONLY:u(g.listen(w,'click',function(event){m.set(w,"Loading...");if(i.hasClass(w,'async_saving')){event.preventDefault();return;}var z=i.hasClass(w,"_5m-"),aa=k.byClass(w,'timelineUnitContainer'),ba=new n(w.getAttribute('ajaxify')),ca=ba.getQueryData().customize_action,da=ca==v.ACTION_STAR?v.starUnit:v.unstarUnit;if(z){i.toggleClass(w,"_5m_");}else{h.setEnabled.curry(w,false).defer();i.toggleClass(w,'fbTimelineStarButtonSelected');i.toggleClass(w,'selected');}da(aa,null,true);var ea=ca==v.ACTION_STAR?v.ACTION_UNSTAR:v.ACTION_STAR;ba.addQueryData({customize_action:ea});w.setAttribute.bind(w,'ajaxify',ba).defer();}));var y=k.byClass(w,'stat_elem');y&&i.removeClass(y,'stat_elem');break;case v.STAR_ASYNC_REQUIRED:u(g.listen(w,'click',function(event){m.set(w,"Loading...");}));break;}}};e.exports=v;});
__d("TimelineStickyHeaderComposerX",["Event","Arbiter","Bootloader","CSS","ComposerXController","DOMQuery","Parent","Run","TimelineComposerUtilities","TimelineContentLoader","TimelineStickyHeader","Vector","copyProperties","csx","cx"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Arbiter'),i=b('Bootloader'),j=b('CSS'),k=b('ComposerXController'),l=b('DOMQuery'),m=b('Parent'),n=b('Run'),o=b('TimelineComposerUtilities'),p=b('TimelineContentLoader'),q=b('TimelineStickyHeader'),r=b('Vector'),s=b('copyProperties'),t=b('csx'),u=b('cx');function v(x){return x&&m.byClass(x.getContext(),"_2wp");}function w(x){this._composerRoot=x;this._tokens=[o.listenToSetEstimatedDate(this._composerRoot,p.capsuleForCurrentSection),o.listenToPublish(this._composerRoot,this._close.bind(this)),h.subscribe('PhotoSnowlift.OPEN',this._close.bind(this)),h.subscribe('TimelineMLE/mleFlyoutShown',function(y,z){if(v(z)===this._composerRoot)k.reset(this._composerRoot);}.bind(this)),h.subscribe('composer/initializedAttachment',function(y,z){if(z.composerRoot===this._composerRoot){this._registerClickToDismiss();if(!z.isInitial)this._closeMLE();}else this._close();}.bind(this)),h.subscribe(q.ADJUST_WIDTH,this._toggleNarrowMode.bind(this))];this._clickCancelToken=o.listenToCancel(this._composerRoot,this._close.bind(this));n.onLeave(function(){while(this._tokens.length)this._tokens.pop().unsubscribe();this._clearClickDismissToken();if(this._clickCancelToken){this._clickCancelToken.remove();this._clickCancelToken=null;}}.bind(this));}s(w.prototype,{_toggleNarrowMode:function(event,x){i.loadModules(['Tooltip'],function(y){var z=r.getElementDimensions(x).x>400,aa=l.scry(this._composerRoot,"._9lb");j.conditionClass(this._composerRoot,"_2wq",z);for(var ba=0;ba<aa.length;ba++){var ca=aa[ba],da=l.getText(ca);if(z){y.set(ca,da);}else y.remove(ca);}}.bind(this));return false;},_registerClickToDismiss:function(){var x=j.hasClass(l.find(this._composerRoot,"._yq"),"_519b");if(!x){this._clearClickDismissToken();return;}this._clickDismissToken=g.listen(document.body,'click',function(y){var z=m.byClass(y.getTarget(),"_2wp");if(!z){this._close();this._clearClickDismissToken();}}.bind(this));},_clearClickDismissToken:function(){if(this._clickDismissToken){this._clickDismissToken.remove();this._clickDismissToken=null;}},_close:function(){this._clearClickDismissToken();this._closeMLE();k.reset(this._composerRoot);},_closeMLE:function(){i.loadModules(['TimelineMLE'],function(x){var y=x.getFlyout();if(v(y)===this._composerRoot)x.hideFlyout();}.bind(this));}});e.exports=w;});
__d("TimelineViewportTracking",["Class","DOM","ViewportTracking","$","copyProperties"],function(a,b,c,d,e,f){var g=b('Class'),h=b('DOM'),i=b('ViewportTracking'),j=b('$'),k=b('copyProperties'),l=55;function m(){this.parent.construct(this);}g.extend(m,i);k(m.prototype,{getDataFromConfig:function(n){this.timeout=n.record_delay;},getTimeout:function(){return this.timeout;},getAllStories:function(){return h.scry(j('timeline_tab_content'),'.timelineUnitContainer');},getStoryID:function(n){var o=JSON.parse(n.getAttribute('data-gt'));return o&&o.contentid;},getDataToLog:function(n){var o={evt:l,timelineviewporttracking:true};return {gt:o};}});e.exports.init=function(n){(new m()).init(n);};});
__d("profile-pic-dragdrop-edit",["Arbiter","SinglePictureUploadTarget","TimelineProfilePic"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('SinglePictureUploadTarget'),i=b('TimelineProfilePic');f.initialize_profile_pic_drop_target=function(j,k,l,m){new i(l,m);new h(j,k).setPreprocessCallback(function(n){g.inform(l.LOADING,{isLoading:1},g.BEHAVIOR_STATE);}).setOncompleteCallback(function(){g.inform(l.LOADING,{isLoading:0},g.BEHAVIOR_STATE);}).setAfterSuccessCallback(function(n){g.inform(l.SUCCESS,{newPic:n.photo_html},g.BEHAVIOR_STATE);}).activate();};});
__d("legacy:TimelineCover",["TimelineCover"],function(a,b,c,d){a.TimelineCover=b('TimelineCover');},3);
__d("OnlyMeUI",["AudienceSelector","Arbiter","CSS","DOM","Parent","PrivacyConst","Selector","$","tx"],function(a,b,c,d,e,f){var g=b('AudienceSelector'),h=b('Arbiter'),i=b('CSS'),j=b('DOM'),k=b('Parent'),l=b('PrivacyConst'),m=b('Selector'),n=b('$'),o=b('tx');function p(){return [j.create('div',{className:'onlyMeBorder'}),j.create('div',{className:'onlyMeBorder onlyMeBorderBottom'})];}function q(){return j.create('img',{alt:' ',className:'onlyMePrivacyCorner',height:34,src:'/images/profile/timeline/privacy_corner.png',width:34});}function r(x){var y=j.scry(x,'.photoUnit a.photo');return y.filter(function(z){return !j.scry(z,'.onlyMePrivacyCorner').length;});}function s(x,y){if(g.hasTags(u(y)))return;if(i.hasClass(x,'storyContent'))if(!k.byClass(x,'onlyMeWrap')){var z=j.create('div',{className:'onlyMeWrap'});j.appendContent(k.byClass(x,'uiStreamStory'),z);j.appendContent(z,x);x=z;}else x=k.byClass(x,'onlyMeWrap');i.addClass(x,'storyOnlyMe');if(!i.hasClass(x,'timelineRecentActivityStory'))j.setContent(j.find(y,'span.uiButtonText'),"Only me");if(!i.hasClass(x,'storyContent')){var aa=r(x);for(var ba=0,ca=aa.length;ba<ca;++ba)j.appendContent(aa[ba],q());}if(!j.scry(x,'div.onlyMeBorder').length){var da=p();j.prependContent(x,da[0]);j.appendContent(x,da[1]);}}function t(x){if(!x)return;var y=k.byClass(x,'storyContent')||k.byClass(x,'timelineRecentActivityStory')||k.byClass(x,'timelineUnitContainer')||k.byClass(x,'fbTimelineTwoColumn');if(!y){y=j.scry(x,'^.permalink_stream .storyContent');y=y.length&&y[0];}else if(i.hasClass(y,'fbTimelineComposerUnit'))return null;return y;}function u(x){var y=j.scry(x,'*[data-oid]');if(y.length===0)return '';return y[0].getAttribute('data-oid');}var v=false,w={init:function(){if(v)return;v=true;h.subscribe('AudienceSelector/changed',function(x,y){if(y.selector&&i.hasClass(y.selector,'blacklistOnlyMeUI'))return;var z=t(y.selector)||t(y.clone);if(!z)return;if(m.getOptionValue(y.option)==l.BaseValue.SELF){s(z,y.selector);}else{z=i.hasClass(z,'storyContent')?k.byClass(z,'onlyMeWrap'):z;z&&i.removeClass(z,'storyOnlyMe');}});},setOnlyMe:function(x){if(v)return;w.init();x=j.find(k.byClass(n(x),'uiSelector'),'a.uiSelectorButton');var y=t(x);y&&s(y,x);}};e.exports=w;});
__d("CountButtonCount",["ArbiterMixin","copyProperties","DOM"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('copyProperties'),i=b('DOM');function j(k,l,m){this._root=k;this._count=l;this._max=m;}h(j.prototype,g,{getCount:function(){return this._count;},setCount:function(k){this._count=k;var l=this.getDisplayedValue();i.setContent(this._root,l);this.inform('change',{value:this._count,max:this._max,display:l});return this;},addCount:function(k){this.setCount(this.getCount()+k);return this;},getDisplayedValue:function(k){var l=(this._count>this._max)?'+':'';return Math.max(0,Math.min(this._count,this._max))+l;}});e.exports=j;});
__d("CountButton",["copyProperties","CSS","cx"],function(a,b,c,d,e,f){var g=b('copyProperties'),h=b('CSS'),i=b('cx'),j={huge:"_4q9",large:"_9x",small:"_9w",hidden:"_9v"};function k(l,m){this._root=l;this._counter=m;this._initEvents();}g(k.prototype,{_initEvents:function(){this._counter.subscribe('change',this._counterChange.bind(this));},_counterChange:function(l,m){h.removeClass(this._root,j.huge);h.removeClass(this._root,j.large);h.removeClass(this._root,j.small);h.removeClass(this._root,j.hidden);var n=m.count>m.max;if(n&&m.max>9){h.addClass(this._root,j.huge);}else if(m.value>9||(n&&m.max>0)){h.addClass(this._root,j.large);}else if(m.value>0){h.addClass(this._root,j.small);}else h.addClass(this._root,j.hidden);},getCounter:function(){return this._counter;}});e.exports=k;});
__d("SubMenu",["Event","Arbiter","copyProperties","CSS"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Arbiter'),i=b('copyProperties'),j=b('CSS');function k(){}i(k.prototype,{_subMenu:null,_mainMenu:null,_forward:null,_backward:null,init:function(l,m,n,o){this._subMenu=l;this._mainMenu=m;this._forward=n;this._backward=o;h.subscribe('SubMenu/Reset',this._goToMainMenu.bind(this));g.listen(n,'click',this._goToSubMenu.bind(this));g.listen(o,'click',this._goToMainMenu.bind(this));},initAsyncChildMenu:function(l){g.listen(this._forward,'click',function(){this._goToSubMenu();l.load();}.bind(this));},_goToMainMenu:function(){j.hide(this._subMenu);j.show(this._mainMenu);},_goToSubMenu:function(){j.hide(this._mainMenu);j.show(this._subMenu);}});e.exports=k;});
__d("legacy:ui-submenu",["SubMenu"],function(a,b,c,d){a.SubMenu=b('SubMenu');},3);
__d("AsyncMenu",["AsyncRequest","copyProperties","emptyFunction"],function(a,b,c,d,e,f){var g=b('AsyncRequest'),h=b('copyProperties'),i=b('emptyFunction');function j(k,l){this._uri=k;this._elem=l;}h(j.prototype,{_uri:null,_elem:null,load:function(){this.load=i;g.bootstrap(this._uri,this._elem);}});e.exports=j;});